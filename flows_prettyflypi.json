[
    {
        "id": "f96f5bad.c1be68",
        "type": "tab",
        "label": "Test Hydro Device",
        "disabled": true,
        "info": ""
    },
    {
        "id": "b380ea3.5456418",
        "type": "tab",
        "label": "Test Hydro",
        "disabled": true,
        "info": ""
    },
    {
        "id": "fc63f1e1.59ede",
        "type": "tab",
        "label": "Hyrdo Prod Flow",
        "disabled": true,
        "info": ""
    },
    {
        "id": "83b19753.1af4a8",
        "type": "tab",
        "label": "IR Test Flow",
        "disabled": true,
        "info": ""
    },
    {
        "id": "aeb6abf8.6695",
        "type": "tab",
        "label": "IR Flows",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3858decf.0fe052",
        "type": "tab",
        "label": "Alexa Commands",
        "disabled": false,
        "info": ""
    },
    {
        "id": "7d076915.bef778",
        "type": "tab",
        "label": "AWS Flows",
        "disabled": true,
        "info": ""
    },
    {
        "id": "3ab1b3d8.bd433c",
        "type": "tab",
        "label": "Notifications",
        "disabled": true,
        "info": ""
    },
    {
        "id": "ecafbd20.fc3e8",
        "type": "tab",
        "label": "HASS Test Flow",
        "disabled": true,
        "info": ""
    },
    {
        "id": "91083d3a.54dc1",
        "type": "tab",
        "label": "Automation Switches",
        "disabled": true,
        "info": ""
    },
    {
        "id": "180daee1.f8c5a1",
        "type": "tab",
        "label": "LIVE SONOFF RF Test Flows",
        "disabled": true,
        "info": ""
    },
    {
        "id": "9abde8e2.4b7518",
        "type": "tab",
        "label": "Misc",
        "disabled": false,
        "info": ""
    },
    {
        "id": "7c38d180.0695d",
        "type": "tab",
        "label": "HASS Prod Flow",
        "disabled": true,
        "info": ""
    },
    {
        "id": "53b9a091.ecbea",
        "type": "tab",
        "label": "Heating Flows",
        "disabled": true,
        "info": ""
    },
    {
        "id": "c85a3990.712ae8",
        "type": "tab",
        "label": "Alexa TTS",
        "disabled": true,
        "info": ""
    },
    {
        "id": "7d5e0229.53f9e4",
        "type": "tab",
        "label": "Motion Detection",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5365d4a0.afc36c",
        "type": "tab",
        "label": "Washing Machine",
        "disabled": false,
        "info": ""
    },
    {
        "id": "fd719e13.69936",
        "type": "tab",
        "label": "Tumble Dryer",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d4f39d50.9849d",
        "type": "tab",
        "label": "Dishwasher",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9d235989.43e7e8",
        "type": "tab",
        "label": "EV Charging",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d8526939.b993a8",
        "type": "tab",
        "label": "Telegram Notifications",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5012390b.b0f3b",
        "type": "subflow",
        "name": "Set Starting Variables",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "33d49fdc.7d2d"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 600,
                "y": 40,
                "wires": [
                    {
                        "id": "33d49fdc.7d2d",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "d033bdb8.8c963",
        "type": "subflow",
        "name": "Calc Cost & Usage",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "8d63705f.7da0c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 420,
                "y": 20,
                "wires": [
                    {
                        "id": "8d63705f.7da0c",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "b113ebbe.a57308",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt",
        "port": "1883",
        "clientid": "node-red-pi",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "iot/nodered/status",
        "birthQos": "0",
        "birthRetain": "true",
        "birthPayload": "connected",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "iot/nodered/status",
        "willQos": "0",
        "willRetain": "true",
        "willPayload": "disconnected"
    },
    {
        "id": "76993064.c8927",
        "type": "alexa-home-conf",
        "username": "markc303"
    },
    {
        "id": "1d68d899.7ab677",
        "type": "alexa-remote-account",
        "name": "",
        "authMethod": "proxy",
        "proxyOwnIp": "192.168.1.6",
        "proxyPort": "3456",
        "cookieFile": "/output.txt",
        "refreshInterval": "3",
        "alexaServiceHost": "alexa.amazon.co.uk",
        "amazonPage": "amazon.co.uk",
        "acceptLanguage": "en-UK",
        "userAgent": "",
        "useWsMqtt": "on",
        "autoInit": "on"
    },
    {
        "id": "df8c46b8.7f5ff8",
        "type": "server",
        "d": true,
        "name": "Home Assistant (dev)",
        "legacy": false,
        "addon": false,
        "rejectUnauthorizedCerts": true,
        "ha_boolean": "y|yes|true|on|home|open",
        "connectionDelay": true,
        "cacheJson": true
    },
    {
        "id": "a4a1abdf.7ba5b8",
        "type": "server",
        "name": "Home Assistant Prod",
        "legacy": false,
        "addon": false,
        "rejectUnauthorizedCerts": true,
        "ha_boolean": "y|yes|true|on|home|open",
        "connectionDelay": true,
        "cacheJson": true
    },
    {
        "id": "a6a7a981.db5148",
        "type": "profile",
        "name": "Weekday Profile",
        "time1": "00:00",
        "temp1": "18",
        "time2": "05:00",
        "temp2": "21",
        "time3": "07:00",
        "temp3": "18",
        "time4": "18:00",
        "temp4": "21",
        "time5": "20:00",
        "temp5": "18",
        "time6": "23:59",
        "temp6": "18",
        "time7": "",
        "temp7": "",
        "time8": "",
        "temp8": "",
        "time9": "",
        "temp9": "",
        "time10": "",
        "temp10": ""
    },
    {
        "id": "662613ce.27d1dc",
        "type": "profile",
        "name": "Fully on til 22:30",
        "time1": "00:00",
        "temp1": "22",
        "time2": "22:30",
        "temp2": "22",
        "time3": "22:30",
        "temp3": "0",
        "time4": "23:59",
        "temp4": "0",
        "time5": "",
        "temp5": "",
        "time6": "",
        "temp6": "",
        "time7": "",
        "temp7": "",
        "time8": "",
        "temp8": "",
        "time9": "",
        "temp9": "",
        "time10": "",
        "temp10": ""
    },
    {
        "id": "6a77b178.df07e8",
        "type": "profile",
        "name": "Central Heating Timer (Weekday)",
        "time1": "00:00",
        "temp1": "0",
        "time2": "05:30",
        "temp2": "0",
        "time3": "05:30",
        "temp3": "25",
        "time4": "08:30",
        "temp4": "25",
        "time5": "08:30",
        "temp5": "0",
        "time6": "18:30",
        "temp6": "0",
        "time7": "18:30",
        "temp7": "25",
        "time8": "22:30",
        "temp8": "25",
        "time9": "22:30",
        "temp9": "0",
        "time10": "23:59",
        "temp10": "0"
    },
    {
        "id": "f4bd15ce.d7f57",
        "type": "profile",
        "name": "Central Heating Timer (Weekend)",
        "time1": "00:00",
        "temp1": "0",
        "time2": "05:30",
        "temp2": "25",
        "time3": "08:30",
        "temp3": "0",
        "time4": "12:00",
        "temp4": "25",
        "time5": "17:00",
        "temp5": "0",
        "time6": "21:30",
        "temp6": "25",
        "time7": "23:00",
        "temp7": "0",
        "time8": "23:59",
        "temp8": "0",
        "time9": "",
        "temp9": "",
        "time10": "",
        "temp10": ""
    },
    {
        "id": "604b417d.8455a",
        "type": "postgresdb",
        "d": true,
        "hostname": "localhost",
        "port": "5432",
        "db": "postgres",
        "ssl": false
    },
    {
        "id": "31d003e1.aa82cc",
        "type": "chatbot-telegram-node",
        "botname": "pfhassbot_logs",
        "usernames": "",
        "providerToken": "1330235613:AAE7UHhGQPgzvSc-MJsFnk4KyF5YaU91s5Y",
        "polling": "1000",
        "store": "",
        "log": "",
        "debug": true,
        "webHook": "",
        "connectMode": "polling"
    },
    {
        "id": "a0589f1a.811e8",
        "type": "telegram bot",
        "d": true,
        "botname": "Home Assistant Logs",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "d4f057b1.bf3418",
        "type": "influxdb",
        "hostname": "influxdb",
        "port": "8086",
        "protocol": "http",
        "database": "energy.autogen",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://influxdb:8086",
        "rejectUnauthorized": false
    },
    {
        "id": "eeb221fb.ab27f",
        "type": "influxdb",
        "d": true,
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "test",
        "name": "test",
        "usetls": true,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "d50d0c9f.31e858",
        "type": "tls-config",
        "name": "",
        "cert": "",
        "key": "",
        "ca": "",
        "certname": "",
        "keyname": "",
        "caname": "",
        "servername": "",
        "verifyservercert": false
    },
    {
        "id": "c554ac1b.11e4",
        "type": "chatbot-telegram-node",
        "botname": "Pfhassbot",
        "usernames": "1308833361",
        "providerToken": "1330235613:AAE7UHhGQPgzvSc-MJsFnk4KyF5YaU91s5Y",
        "polling": "1000",
        "store": "",
        "log": "pfhassbot_chat_log",
        "debug": false,
        "webHook": "",
        "connectMode": "polling"
    },
    {
        "id": "61c78e43.6e203",
        "type": "chatbot-telegram-node",
        "botname": "pfnodered_bot",
        "usernames": "1308833361",
        "providerToken": "1502180117:AAHpM844ZEPUP0-jwtiDBWpB3fQRYbduZNQ",
        "polling": "1000",
        "store": "",
        "log": "",
        "debug": false,
        "webHook": "",
        "connectMode": "polling"
    },
    {
        "id": "966c07b8.c25848",
        "type": "inject",
        "z": "b380ea3.5456418",
        "name": "Pump Start Interval",
        "repeat": "60",
        "crontab": "",
        "once": false,
        "topic": "iot/home/hydro/pump/state",
        "payload": "",
        "payloadType": "date",
        "x": 129.5,
        "y": 185,
        "wires": [
            [
                "cd099026.82e67",
                "dff5c3a5.c99b9"
            ]
        ]
    },
    {
        "id": "fd7db601.d2d088",
        "type": "mqtt out",
        "z": "b380ea3.5456418",
        "name": "",
        "topic": "iot/home/hydro/pump/set",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 570,
        "y": 120,
        "wires": []
    },
    {
        "id": "37ea6ff2.efeea",
        "type": "mqtt out",
        "z": "b380ea3.5456418",
        "name": "",
        "topic": "iot/home/hydro/pump/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 582,
        "y": 243,
        "wires": []
    },
    {
        "id": "208448e4.3e5098",
        "type": "debug",
        "z": "b380ea3.5456418",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 539.5,
        "y": 294,
        "wires": []
    },
    {
        "id": "dff5c3a5.c99b9",
        "type": "delay",
        "z": "b380ea3.5456418",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 192.5,
        "y": 288,
        "wires": [
            [
                "faa906d1.6e6a18"
            ]
        ]
    },
    {
        "id": "cd099026.82e67",
        "type": "template",
        "z": "b380ea3.5456418",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\n  \"status\": \"ON\",\n  \"timestamp\": \"9234801090400\",\n  \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 350.5,
        "y": 183,
        "wires": [
            [
                "fd7db601.d2d088",
                "fa062dc.913a9d"
            ]
        ]
    },
    {
        "id": "faa906d1.6e6a18",
        "type": "template",
        "z": "b380ea3.5456418",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\n  \"status\": \"OFF\",\n  \"timestamp\": \"9234801090400\",\n  \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 361,
        "y": 275,
        "wires": [
            [
                "37ea6ff2.efeea",
                "208448e4.3e5098"
            ]
        ]
    },
    {
        "id": "6b3162de.02407c",
        "type": "inject",
        "z": "b380ea3.5456418",
        "name": "Get Level",
        "repeat": "1800",
        "crontab": "",
        "once": true,
        "topic": "/iot/hydro/hydro-main/level/set",
        "payload": "get-level",
        "payloadType": "str",
        "x": 160.5,
        "y": 423,
        "wires": [
            [
                "dcf8e825.ff5508",
                "b2fdd235.52996"
            ]
        ]
    },
    {
        "id": "dcf8e825.ff5508",
        "type": "mqtt out",
        "z": "b380ea3.5456418",
        "name": "",
        "topic": "iot/home/hydro/pump/level",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 443.5,
        "y": 408,
        "wires": []
    },
    {
        "id": "b2fdd235.52996",
        "type": "debug",
        "z": "b380ea3.5456418",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 414.5,
        "y": 468,
        "wires": []
    },
    {
        "id": "1cae32c2.fd2dcd",
        "type": "mqtt in",
        "z": "f96f5bad.c1be68",
        "name": "Receive Level Request",
        "topic": "iot/home/hydro/pump/level",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 197.5,
        "y": 96,
        "wires": [
            [
                "b30a33db.d0197"
            ]
        ]
    },
    {
        "id": "936dee29.4170e",
        "type": "mqtt out",
        "z": "f96f5bad.c1be68",
        "name": "Send Level",
        "topic": "/iot-test/hydro/hydro-main/level",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 642.5,
        "y": 84,
        "wires": []
    },
    {
        "id": "b30a33db.d0197",
        "type": "template",
        "z": "f96f5bad.c1be68",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"level\":\"123\"}",
        "output": "str",
        "x": 446.5,
        "y": 92,
        "wires": [
            [
                "936dee29.4170e"
            ]
        ]
    },
    {
        "id": "90e52247.8949",
        "type": "mqtt in",
        "z": "f96f5bad.c1be68",
        "name": "Pump Status Change",
        "topic": "iot/home/hydro/pump/state",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 195,
        "y": 199,
        "wires": [
            [
                "bca50060.8df7c"
            ]
        ]
    },
    {
        "id": "bca50060.8df7c",
        "type": "mqtt out",
        "z": "f96f5bad.c1be68",
        "name": "Send Level",
        "topic": "iot/home/hydro/pump/state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 602,
        "y": 213,
        "wires": []
    },
    {
        "id": "f7380a22.d36088",
        "type": "inject",
        "z": "fc63f1e1.59ede",
        "name": "Trigger at start",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "topic": "null",
        "payload": "",
        "payloadType": "date",
        "x": 122.5,
        "y": 69,
        "wires": [
            [
                "a9b2121a.15494"
            ]
        ]
    },
    {
        "id": "fa062dc.913a9d",
        "type": "debug",
        "z": "b380ea3.5456418",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 550,
        "y": 200,
        "wires": []
    },
    {
        "id": "a708cc09.44af7",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 557.5,
        "y": 85,
        "wires": [
            [
                "92a94855.ac4568",
                "9aceba0a.e685e8"
            ]
        ]
    },
    {
        "id": "a9b2121a.15494",
        "type": "file in",
        "z": "fc63f1e1.59ede",
        "name": "Read Hydro Config Data",
        "filename": ".node-red/data/hydro-config.json",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 365.5,
        "y": 85,
        "wires": [
            [
                "a708cc09.44af7"
            ]
        ]
    },
    {
        "id": "92a94855.ac4568",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "Timing Calc",
        "func": "var interval = msg.payload[\"pump-interval-min\"];\nvar duration = msg.payload[\"pump-duration-secs\"];\n\nvar d = new Date();\nvar minsSinceMid = (d.getHours() * 60) + d.getMinutes();\n\n\nif (minsSinceMid % interval === 0) {\n    msg.delay = duration*1000;\n    return msg;\n} else { \n    return null;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 116.5,
        "y": 226,
        "wires": [
            [
                "f34b638f.2067b",
                "b4976c33.79bde"
            ]
        ]
    },
    {
        "id": "7ad22e46.7bc76",
        "type": "debug",
        "z": "fc63f1e1.59ede",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 788.5,
        "y": 278,
        "wires": []
    },
    {
        "id": "f34b638f.2067b",
        "type": "delay",
        "z": "fc63f1e1.59ede",
        "name": "delay for off message",
        "pauseType": "delayv",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 141.5,
        "y": 338,
        "wires": [
            [
                "9334495a.c5b548"
            ]
        ]
    },
    {
        "id": "b4976c33.79bde",
        "type": "template",
        "z": "fc63f1e1.59ede",
        "name": "ON JSON",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n  \"status\": \"ON\",\n  \"timestamp\": \"9234801090400\",\n  \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 284.5,
        "y": 234,
        "wires": [
            [
                "22aa2d12.60eed2"
            ]
        ]
    },
    {
        "id": "9334495a.c5b548",
        "type": "template",
        "z": "fc63f1e1.59ede",
        "name": "OFF JSON",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n  \"status\": \"OFF\",\n  \"timestamp\": \"9234801090400\",\n  \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 330,
        "y": 338,
        "wires": [
            [
                "748b526f.95e67c"
            ]
        ]
    },
    {
        "id": "6b7738b1.13e098",
        "type": "debug",
        "z": "fc63f1e1.59ede",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 817.5,
        "y": 361,
        "wires": []
    },
    {
        "id": "22aa2d12.60eed2",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 447.5,
        "y": 232,
        "wires": [
            [
                "b2fb4e9a.005da"
            ]
        ]
    },
    {
        "id": "b2fb4e9a.005da",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "Add time",
        "func": "var d = new Date();\nvar timestamp = d.toJSON();\n\nmsg.payload[\"timestamp\"] = timestamp;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 587.5,
        "y": 232,
        "wires": [
            [
                "7ad22e46.7bc76",
                "5c020de2.841054"
            ]
        ]
    },
    {
        "id": "748b526f.95e67c",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 470,
        "y": 347,
        "wires": [
            [
                "eb677bb.8d40288"
            ]
        ]
    },
    {
        "id": "eb677bb.8d40288",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "Add time",
        "func": "var d = new Date();\nvar timestamp = d.toJSON();\n\nmsg.payload[\"timestamp\"] = timestamp;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 597,
        "y": 348,
        "wires": [
            [
                "6b7738b1.13e098",
                "3875603.c5e5da"
            ]
        ]
    },
    {
        "id": "ae00fa7.9324c08",
        "type": "mqtt in",
        "z": "fc63f1e1.59ede",
        "name": "Interval Update Msg",
        "topic": "iot/hydro/config/interval",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 95,
        "y": 444,
        "wires": [
            [
                "81e91b24.363e98"
            ]
        ]
    },
    {
        "id": "92d6fe16.3af5e",
        "type": "inject",
        "z": "fc63f1e1.59ede",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 88.5,
        "y": 805,
        "wires": [
            [
                "8a6b3098.aba5d"
            ]
        ]
    },
    {
        "id": "8a6b3098.aba5d",
        "type": "template",
        "z": "fc63f1e1.59ede",
        "name": "interval",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"pump-interval-min\":\"5\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 249.5,
        "y": 803,
        "wires": [
            [
                "79c70608.a94e78"
            ]
        ]
    },
    {
        "id": "79c70608.a94e78",
        "type": "mqtt out",
        "z": "fc63f1e1.59ede",
        "name": "",
        "topic": "iot/hydro/config/interval",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 449.5,
        "y": 811,
        "wires": []
    },
    {
        "id": "81e91b24.363e98",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 237,
        "y": 484,
        "wires": [
            [
                "19a13592.cf77ea"
            ]
        ]
    },
    {
        "id": "19a13592.cf77ea",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "",
        "func": "//var flowContext = this.context().flow;\n\n//var interval = msg.payload[\"pump-interval-min\"];\n//var client = msg.payload[\"client\"];\n\nflow.set(\"interval\", msg.payload[\"pump-interval-min\"]);\nflow.set(\"client\", msg.payload[\"client\"]);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 325.5,
        "y": 524,
        "wires": [
            [
                "e2eefa68.cf2948"
            ]
        ]
    },
    {
        "id": "caf8482a.449a88",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 610,
        "y": 477,
        "wires": [
            [
                "e7ff80cd.391fb"
            ]
        ]
    },
    {
        "id": "e2eefa68.cf2948",
        "type": "file in",
        "z": "fc63f1e1.59ede",
        "name": "Read Hydro Config Data",
        "filename": ".node-red/data/hydro-config.json",
        "format": "utf8",
        "chunk": false,
        "sendError": true,
        "x": 435,
        "y": 445,
        "wires": [
            [
                "caf8482a.449a88"
            ]
        ]
    },
    {
        "id": "319bd4fd.3a1c6c",
        "type": "comment",
        "z": "fc63f1e1.59ede",
        "name": "Confg Msgs",
        "info": "//For pump interval\n{\n    \"pump-interval-min\":\"5\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"client-id\"\n}\n\n//For pump duration\n{\n    \"pump-duration-secs\":\"5\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"client-id\"\n}",
        "x": 75,
        "y": 406,
        "wires": []
    },
    {
        "id": "53ff950a.bb8a4c",
        "type": "template",
        "z": "fc63f1e1.59ede",
        "name": "duration",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"pump-duration-secs\":\"15\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"node-red\"\n}",
        "output": "str",
        "x": 241,
        "y": 858,
        "wires": [
            [
                "f5d6ca7e.998e18"
            ]
        ]
    },
    {
        "id": "87d845eb.533858",
        "type": "inject",
        "z": "fc63f1e1.59ede",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 80,
        "y": 860,
        "wires": [
            [
                "53ff950a.bb8a4c"
            ]
        ]
    },
    {
        "id": "f5d6ca7e.998e18",
        "type": "mqtt out",
        "z": "fc63f1e1.59ede",
        "name": "",
        "topic": "iot/hydro/config/duration",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 441,
        "y": 866,
        "wires": []
    },
    {
        "id": "e7ff80cd.391fb",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "Add time & updates",
        "func": "var d = new Date();\nvar timestamp = d.toJSON();\n\nmsg.payload[\"pump-interval-min\"] = flow.get(\"interval\");\nmsg.payload[\"last-updated-time\"] = timestamp;\nmsg.payload[\"last-updated-by\"] = flow.get(\"client\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 656,
        "y": 531,
        "wires": [
            [
                "577cecab.3f7c64",
                "33907d7e.bf69e2"
            ]
        ]
    },
    {
        "id": "3ccc7767.300d78",
        "type": "file",
        "z": "fc63f1e1.59ede",
        "name": "",
        "filename": ".node-red/data/hydro-config.json",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 858.5,
        "y": 584,
        "wires": [
            []
        ]
    },
    {
        "id": "577cecab.3f7c64",
        "type": "debug",
        "z": "fc63f1e1.59ede",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 832.5,
        "y": 497,
        "wires": []
    },
    {
        "id": "33907d7e.bf69e2",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": true,
        "x": 645.5,
        "y": 585,
        "wires": [
            [
                "3ccc7767.300d78"
            ]
        ]
    },
    {
        "id": "796726f7.034778",
        "type": "mqtt in",
        "z": "fc63f1e1.59ede",
        "name": "Duration Update Msg",
        "topic": "iot/hydro/config/duration",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 105,
        "y": 621,
        "wires": [
            [
                "3b3a71d2.34d3de"
            ]
        ]
    },
    {
        "id": "3b3a71d2.34d3de",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 237,
        "y": 661,
        "wires": [
            [
                "c0d37a04.1f4ed8"
            ]
        ]
    },
    {
        "id": "c0d37a04.1f4ed8",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "",
        "func": "flow.set(\"duration\", msg.payload[\"pump-duration-secs\"]);\nflow.set(\"client\", msg.payload[\"client\"]);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 325.5,
        "y": 701,
        "wires": [
            [
                "f7aa7110.bb43c"
            ]
        ]
    },
    {
        "id": "f7aa7110.bb43c",
        "type": "file in",
        "z": "fc63f1e1.59ede",
        "name": "Read Hydro Config Data",
        "filename": ".node-red/data/hydro-config.json",
        "format": "utf8",
        "chunk": false,
        "sendError": true,
        "x": 429,
        "y": 618,
        "wires": [
            [
                "6d5e7d74.f64f64"
            ]
        ]
    },
    {
        "id": "6d5e7d74.f64f64",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": false,
        "x": 586,
        "y": 650,
        "wires": [
            [
                "cc77878b.100358"
            ]
        ]
    },
    {
        "id": "cc77878b.100358",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "Add time & updates",
        "func": "var d = new Date();\nvar timestamp = d.toJSON();\n\nmsg.payload[\"pump-duration-secs\"] = flow.get(\"duration\");\nmsg.payload[\"last-updated-time\"] = timestamp;\nmsg.payload[\"last-updated-by\"] = flow.get(\"client\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 645,
        "y": 706,
        "wires": [
            [
                "ef33b122.4461e",
                "8193a2ca.b208c"
            ]
        ]
    },
    {
        "id": "ef33b122.4461e",
        "type": "debug",
        "z": "fc63f1e1.59ede",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 825.5,
        "y": 673,
        "wires": []
    },
    {
        "id": "8193a2ca.b208c",
        "type": "json",
        "z": "fc63f1e1.59ede",
        "name": "",
        "pretty": true,
        "x": 643.5,
        "y": 768,
        "wires": [
            [
                "8ce4111.51a44f"
            ]
        ]
    },
    {
        "id": "8ce4111.51a44f",
        "type": "file",
        "z": "fc63f1e1.59ede",
        "name": "",
        "filename": ".node-red/data/hydro-config.json",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 861.5,
        "y": 768,
        "wires": [
            []
        ]
    },
    {
        "id": "99ab8de0.e916c",
        "type": "comment",
        "z": "fc63f1e1.59ede",
        "name": "Test Config Messages",
        "info": "//For pump interval\n{\n    \"pump-interval-min\":\"5\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"client-id\"\n}\n\n//For pump duration\n{\n    \"pump-duration-secs\":\"5\",\n    \"timestamp\": \"2012-04-23T18:25:43.511Z\",\n    \"client\": \"client-id\"\n}",
        "x": 108,
        "y": 761,
        "wires": []
    },
    {
        "id": "f14658dd.ea1eb8",
        "type": "comment",
        "z": "fc63f1e1.59ede",
        "name": "Read Config and Send Messages",
        "info": "",
        "x": 137,
        "y": 32,
        "wires": []
    },
    {
        "id": "2ad64b1a.9ef954",
        "type": "catch",
        "z": "fc63f1e1.59ede",
        "name": "",
        "scope": null,
        "x": 136.5,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "989bba7.5539548",
        "type": "mqtt out",
        "z": "fc63f1e1.59ede",
        "name": "Error Alert",
        "topic": "iot/error",
        "qos": "0",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 465.5,
        "y": 979,
        "wires": []
    },
    {
        "id": "a384405a.6ea16",
        "type": "comment",
        "z": "fc63f1e1.59ede",
        "name": "Catch Errors",
        "info": "",
        "x": 75,
        "y": 935,
        "wires": []
    },
    {
        "id": "9aceba0a.e685e8",
        "type": "debug",
        "z": "fc63f1e1.59ede",
        "name": "",
        "active": false,
        "console": "false",
        "complete": "payload",
        "x": 768,
        "y": 128,
        "wires": []
    },
    {
        "id": "5c020de2.841054",
        "type": "mqtt out",
        "z": "fc63f1e1.59ede",
        "name": "",
        "topic": "iot/home/hydro/pump/set",
        "qos": "1",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 813.5,
        "y": 202,
        "wires": []
    },
    {
        "id": "3875603.c5e5da",
        "type": "mqtt out",
        "z": "fc63f1e1.59ede",
        "name": "",
        "topic": "iot/home/hydro/pump/set",
        "qos": "1",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 834,
        "y": 321,
        "wires": []
    },
    {
        "id": "5bb64995.e7a6c8",
        "type": "function",
        "z": "fc63f1e1.59ede",
        "name": "",
        "func": "\nmsg = error.source.id + \" \" + error.source.type + \" \" + error.source.name\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 279.5,
        "y": 981,
        "wires": [
            [
                "989bba7.5539548"
            ]
        ]
    },
    {
        "id": "e2f18cfd.0ba97",
        "type": "comment",
        "z": "fc63f1e1.59ede",
        "name": "Run NodeRed in home folder",
        "info": "ie. parent folder of .node-red",
        "x": 942.5000076293945,
        "y": 41.25000190734863,
        "wires": []
    },
    {
        "id": "5c32750a.82e58c",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 590,
        "y": 360,
        "wires": []
    },
    {
        "id": "11f4d5f0.b0d72a",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "1,405,0,3",
        "payloadType": "str",
        "x": 380,
        "y": 360,
        "wires": [
            [
                "5c32750a.82e58c",
                "e0e8be95.461f1"
            ]
        ]
    },
    {
        "id": "fbd0bfb6.487bc",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "1,401,0,1",
        "payloadType": "str",
        "x": 380,
        "y": 394,
        "wires": [
            [
                "5c32750a.82e58c",
                "e0e8be95.461f1"
            ]
        ]
    },
    {
        "id": "db62c153.b58ef",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 590,
        "y": 520,
        "wires": []
    },
    {
        "id": "f526874.17bc378",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "TV commands",
        "topic": "iot/media/tv/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 160,
        "y": 560,
        "wires": [
            [
                "4600c67d.36a5f8"
            ]
        ]
    },
    {
        "id": "4600c67d.36a5f8",
        "type": "function",
        "z": "83b19753.1af4a8",
        "name": "Find IR Command",
        "func": "//32' SONY TV COMMANDS\n\nswitch(msg.payload) {\n\ncase \"ON\":\n    msg.payload = \"4,A90,0,1\";\nbreak;\n\ncase \"OFF\":\n    msg.payload = \"4,A90,0,1\";\nbreak;\n\ncase \"VOL_UP\":\n    msg.payload = \"4,490,0,1\";\nbreak;\n\ncase \"VOL_DOWN\":\n    msg.payload = \"4,C90,0,1\";\nbreak;\n\ncase \"CHAN_UP\":\n    msg.payload = \"4,090,0,1\";\nbreak;\n\ncase \"CHAN_DOWN\":\n    msg.payload = \"4,890,0,1\";\nbreak;\n\ncase \"MUTE\":\n    msg.payload = \"4,290,0,1\";\nbreak;\n\ncase \"1\":\n    msg.payload = \"4,010,0,1\";\nbreak;\n\ncase \"2\":\n    msg.payload = \"4,810,0,1\";\nbreak;\n\ncase \"3\":\n    msg.payload = \"4,410,0,1\";\nbreak;\n\ncase \"4\":\n    msg.payload = \"4,C10,0,1\";\nbreak;\n\ncase \"5\":\n    msg.payload = \"4,210,0,1\";\nbreak;\n\ncase \"6\":\n    msg.payload = \"4,A10,0,1\";\nbreak;\n\ncase \"7\":\n    msg.payload = \"4,610,0,1\";\nbreak;\n\ncase \"8\":\n    msg.payload = \"4,E10,0,1\";\nbreak;\n\ncase \"9\":\n    msg.payload = \"4,110,0,1\";\nbreak;\n\ncase \"0\":\n    msg.payload = \"4,910,0,1\";\nbreak;\n\ncase \"UP\":\n    msg.payload = \"4,2F0,0,1\";\nbreak;\n\ncase \"DOWN\":\n    msg.payload = \"4,AF0,0,1\";\nbreak;\n\ncase \"LEFT\":\n    msg.payload = \"4,2D0,0,1\";\nbreak;\n\ncase \"OK\":\n    msg.payload = \"4,A70,0,1\";\nbreak;\n\ncase \"RIGHT\":\n    msg.payload = \"4,CD0,0,1\";\nbreak;\n\ncase \"MENU\":\n    msg.payload = \"4,070,0,1\";\nbreak;\n    \n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 368.5,
        "y": 562,
        "wires": [
            [
                "db62c153.b58ef",
                "8e9fdf29.4e09a"
            ]
        ]
    },
    {
        "id": "7129fca1.bf4ed4",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/media/tv/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 640,
        "y": 60,
        "wires": []
    },
    {
        "id": "67c5d7ce.68ceb8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "iot/media/tv/set",
        "payload": "ON",
        "payloadType": "str",
        "x": 410,
        "y": 60,
        "wires": [
            [
                "7129fca1.bf4ed4",
                "dda6430b.c0776"
            ]
        ]
    },
    {
        "id": "8e9fdf29.4e09a",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "ircontroller/send",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 580,
        "y": 600,
        "wires": []
    },
    {
        "id": "dda6430b.c0776",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 630,
        "y": 100,
        "wires": []
    },
    {
        "id": "186b3b39.561195",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test TV ON ",
        "info": "",
        "x": 210,
        "y": 60,
        "wires": []
    },
    {
        "id": "ae0863c1.8fba",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 590,
        "y": 640,
        "wires": []
    },
    {
        "id": "4f285190.fb573",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "Amp commands",
        "topic": "iot/media/amp/set",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 160,
        "y": 680,
        "wires": [
            [
                "af1e140e.d03d68"
            ]
        ]
    },
    {
        "id": "af1e140e.d03d68",
        "type": "function",
        "z": "83b19753.1af4a8",
        "name": "Find IR Command",
        "func": "//AMP COMMANDS\n\nswitch(msg.payload) {\n\ncase \"CD\":\n    msg.payload = \"1,405,0,2\";\nbreak;\n\ncase \"BD/DVD\":\n    msg.payload = \"1,401,0,1\";\nbreak;\n \ncase \"TUNER\":\n    msg.payload = \"1,403,0,1\";\nbreak;\n\ncase \"VOL_UP\":\n    msg.payload = \"1,416,0,1\";\nbreak;\n\ncase \"VOL_DOWN\":\n    msg.payload = \"1,417,0,1\";\nbreak;\n\ncase \"MUTE\":\n    msg.payload = \"1,413,0,1\";\nbreak;\n\ncase \"ON\":\n    msg.payload = \"1,414,0,1\";\nbreak;\n\ncase \"OFF\":\n    msg.payload = \"1,415,0,1\";\nbreak;\n\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 368.5,
        "y": 682,
        "wires": [
            [
                "ae0863c1.8fba",
                "8c579757.ea40d8"
            ]
        ]
    },
    {
        "id": "8c579757.ea40d8",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 570,
        "y": 720,
        "wires": []
    },
    {
        "id": "b60126cd.570c58",
        "type": "http in",
        "z": "83b19753.1af4a8",
        "name": "",
        "url": "/test",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 121.5,
        "y": 1062,
        "wires": [
            [
                "abff6294.387cc"
            ]
        ]
    },
    {
        "id": "abff6294.387cc",
        "type": "change",
        "z": "83b19753.1af4a8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Hello",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 1060,
        "wires": [
            [
                "4f64a704.5c0638"
            ]
        ]
    },
    {
        "id": "4f64a704.5c0638",
        "type": "http response",
        "z": "83b19753.1af4a8",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 629.5,
        "y": 1056,
        "wires": []
    },
    {
        "id": "2b41aabb.af8e76",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/tv/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 740,
        "y": 80,
        "wires": []
    },
    {
        "id": "785e316c.93a59",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off or Vol",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IncrementPercentageRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "DecrementPercentageRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 280,
        "y": 200,
        "wires": [
            [
                "933b6b84.588b08",
                "18780895.a0ed37",
                "4fe47c4b.9a6e34"
            ],
            [
                "5cd3a981.6e07d8"
            ],
            [
                "1b94bc16.81dca4"
            ],
            [
                "51163b19.7ba8d4"
            ]
        ]
    },
    {
        "id": "933b6b84.588b08",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - TV",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 80,
        "wires": [
            [
                "2b41aabb.af8e76"
            ]
        ]
    },
    {
        "id": "5cd3a981.6e07d8",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 160,
        "wires": [
            [
                "2b41aabb.af8e76"
            ]
        ]
    },
    {
        "id": "8a9b4be0.c052b8",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 720.5,
        "y": 318,
        "wires": []
    },
    {
        "id": "c1b6f38f.d1369",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 290.5,
        "y": 338,
        "wires": [
            [
                "29fd7317.4c9bdc"
            ],
            [
                "54d5a9df.edf7f8"
            ]
        ]
    },
    {
        "id": "29fd7317.4c9bdc",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "CD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440.5,
        "y": 318,
        "wires": [
            [
                "8a9b4be0.c052b8"
            ]
        ]
    },
    {
        "id": "54d5a9df.edf7f8",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440.5,
        "y": 378,
        "wires": [
            [
                "8a9b4be0.c052b8"
            ]
        ]
    },
    {
        "id": "307f2a4f.495a46",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 720.5,
        "y": 438,
        "wires": []
    },
    {
        "id": "ea66abf6.868228",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 290.5,
        "y": 458,
        "wires": [
            [
                "2656f6e0.4bac8a"
            ],
            [
                "df1fe0bc.5fe3f"
            ]
        ]
    },
    {
        "id": "2656f6e0.4bac8a",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "TUNER",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440.5,
        "y": 438,
        "wires": [
            [
                "307f2a4f.495a46"
            ]
        ]
    },
    {
        "id": "df1fe0bc.5fe3f",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440.5,
        "y": 498,
        "wires": [
            [
                "307f2a4f.495a46"
            ]
        ]
    },
    {
        "id": "93fa26c3.f7ce78",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 290.5,
        "y": 958,
        "wires": [
            [
                "51a84ded.485454",
                "58084f24.b4bf4"
            ],
            [
                "6a587ae6.c7ce04"
            ]
        ]
    },
    {
        "id": "6a587ae6.c7ce04",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1040,
        "wires": [
            [
                "77d258f7.8a63b8"
            ]
        ]
    },
    {
        "id": "97bea77d.8a4b18",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 160,
        "wires": []
    },
    {
        "id": "18780895.a0ed37",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - AMP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 120,
        "wires": [
            [
                "97bea77d.8a4b18"
            ]
        ]
    },
    {
        "id": "f96c0900.604078",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 730,
        "y": 1020,
        "wires": []
    },
    {
        "id": "58084f24.b4bf4",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - AMP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 980,
        "wires": [
            [
                "f96c0900.604078"
            ]
        ]
    },
    {
        "id": "51a84ded.485454",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - TV",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 940,
        "wires": [
            [
                "77d258f7.8a63b8"
            ]
        ]
    },
    {
        "id": "77d258f7.8a63b8",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/tv/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 720,
        "y": 940,
        "wires": []
    },
    {
        "id": "1b94bc16.81dca4",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL UP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "UP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 200,
        "wires": [
            [
                "e5b908d3.d08288"
            ]
        ]
    },
    {
        "id": "e5b908d3.d08288",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/vol",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 220,
        "wires": []
    },
    {
        "id": "51163b19.7ba8d4",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL DOWN",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "DOWN",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 240,
        "wires": [
            [
                "e5b908d3.d08288"
            ]
        ]
    },
    {
        "id": "1fc209c3.09c3e6",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test CD ON",
        "info": "",
        "x": 210,
        "y": 360,
        "wires": []
    },
    {
        "id": "88b9f98f.4e5c88",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test BD/DVD ON",
        "info": "",
        "x": 200,
        "y": 400,
        "wires": []
    },
    {
        "id": "47acc084.8aa54",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off or Vol",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IncrementPercentageRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "DecrementPercentageRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 280,
        "y": 680,
        "wires": [
            [
                "931d346d.98f688"
            ],
            [],
            [
                "a13cbe5.ff9aa4"
            ],
            [
                "e9a11dc6.51d34"
            ]
        ]
    },
    {
        "id": "8f381a6f.d4a7d8",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 640,
        "wires": []
    },
    {
        "id": "931d346d.98f688",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - AMP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "BD/DVD",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 640,
        "wires": [
            [
                "8f381a6f.d4a7d8"
            ]
        ]
    },
    {
        "id": "a13cbe5.ff9aa4",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL UP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "UP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 700,
        "wires": [
            [
                "d0a1272e.56c958"
            ]
        ]
    },
    {
        "id": "d0a1272e.56c958",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/vol",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 720,
        "wires": []
    },
    {
        "id": "e9a11dc6.51d34",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL DOWN",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "DOWN",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 740,
        "wires": [
            [
                "d0a1272e.56c958"
            ]
        ]
    },
    {
        "id": "2a14b390.b30b8c",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off or Vol",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "IncrementPercentageRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "DecrementPercentageRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 280,
        "y": 820,
        "wires": [
            [
                "8fc7c445.91a718"
            ],
            [
                "fe4ce1fc.add44"
            ]
        ]
    },
    {
        "id": "8fc7c445.91a718",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL UP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "UP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 800,
        "wires": [
            [
                "8b6216db.83f138"
            ]
        ]
    },
    {
        "id": "8b6216db.83f138",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/amp/vol",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 820,
        "wires": []
    },
    {
        "id": "fe4ce1fc.add44",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "VOL DOWN",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "DOWN",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 840,
        "wires": [
            [
                "8b6216db.83f138"
            ]
        ]
    },
    {
        "id": "df96765.bb9fc88",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 590,
        "y": 800,
        "wires": []
    },
    {
        "id": "2d6c20cf.8b7bd",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "SAT commands",
        "topic": "iot/media/sat/set",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 120,
        "y": 840,
        "wires": [
            [
                "c7e17d69.c93e9"
            ]
        ]
    },
    {
        "id": "c7e17d69.c93e9",
        "type": "function",
        "z": "83b19753.1af4a8",
        "name": "Find IR Command",
        "func": "//YOUVIEW COMMANDS\nvar on = \"226,1070,202,2278,204,718,226,2850,204,1316,176,1344,200,1594,204,1590,204,12320,204,1040,200,2826,204,718,224,748,224,748,224,2850,204,744,200,746,226\";\nvar chandown = \"226,1020,226,2302,204,768,176,2852,204,1316,200,1320,200,1594,204,1590,204,12342,206,1018,194,728,224,748,224,748,224,798,200,2690,204,718,224,748\";\nvar mute = \"236,1036,192,2286,168,802,170,2858,170,1354,166,1352,168,1626,170,1624,168,12356,170,1078,170,1074,170,802,170,804,168,802,170,2446,170,802,170,802,174\";\nvar chanup = \"228,1022,224,2304,202,720,224,2852,204,1316,200,1320,200,1594,204,1588,204,12320,204,1040,176,902,208,746,224,748,224,748,224,2578,204,720,224,770,204\";\nvar up = \"224,1072,202,2278,202,720,224,2852,202,1316,200,1320,200,1594,204,1590,204,12320,204,1040,200,1046,202,2004,202,768,176,1070,202,906,200,772,176,746,224\";\nvar left = \"228,1020,226,2304,202,720,224,2852,204,1316,200,1320,174,1620,204,1590,204,12322,204,1040,176,2030,202,764,204,724,224,1070,176,1208,200,766,206,724,224\";\nvar right = \"228,1020,226,2302,204,718,226,2850,204,1316,176,1344,176,1618,204,1590,204,12318,206,1040,176,1892,204,718,226,746,226,1070,176,1344,176,748,224,796,176\";\nvar down = \"228,1042,206,2302,204,720,224,2852,202,1318,200,1320,200,1594,204,1590,204,12320,204,1042,202,2140,202,722,222,798,200,1046,200,1046,200,766,206,722,224\";\nvar ok = \"228,1020,226,2304,202,720,224,2852,202,1318,174,1346,198,1594,202,1592,202,12322,204,1040,174,1756,202,760,184,798,176,1072,174,1480,174,748,224,778,194\";\n\nvar one = \"226,1072,176,2304,204,718,226,2848,206,1316,176,1344,176,1618,204,1588,206,12318,228,1016,176,1344,176,2028,204,718,226,796,176,932,176,746,226,794,178\";\nvar two = \"224,1072,200,2280,204,720,224,2850,204,1316,176,1346,176,1618,204,1590,204,12320,204,1040,180,1202,176,2030,204,716,226,748,226,1070,198,774,176,796,176\";\nvar three = \"228,1070,178,2300,206,748,196,2850,206,1316,176,1344,176,1618,206,1610,206,12296,206,1040,178,2302,206,766,178,746,226,792,180,1206,176,746,226,796,176\";\nvar four = \"230,1020,226,2302,202,718,226,2850,204,1316,176,1344,174,1618,204,1590,204,12320,204,1042,176,2166,204,718,226,746,224,748,226,1344,176,796,176,746,226\";\nvar five = \"224,1070,178,2302,206,716,226,2850,206,1316,176,1344,176,1618,206,1588,206,12318,232,1014,178,2026,206,752,192,746,226,796,176,1480,176,746,226,746,226\";\nvar six = \"226,1072,178,2302,206,718,226,2850,206,1314,176,1344,176,1618,204,1588,208,12316,206,1038,178,2850,204,2000,206,766,176,784,188,1618,204,766,176,796,176\";\nvar seven = \"224,1072,178,2302,204,718,226,2850,206,1316,176,1346,174,1618,206,1588,204,12320,206,1040,176,2714,204,2004,202,768,178,746,226,1754,204,718,224,744,228\";\nvar eight = \"226,1070,178,2302,206,766,178,2848,206,1314,176,1344,176,1616,206,1588,206,12316,234,1010,178,2574,206,1998,206,766,176,794,178,1890,206,766,178,796,178\";\nvar nine = \"228,1020,226,2302,204,718,224,2852,204,1316,176,1346,174,1620,204,1590,204,12320,204,1042,176,1480,176,796,176,796,176,796,176,2028,204,720,226,746,226\";\nvar zero = \"244,996,208,2300,204,720,226,2850,206,1314,176,1344,176,1618,206,1590,204,12318,206,1040,176,2664,226,780,192,744,230,746,226,794,178,796,176,794,178\";\n\nvar volup = \"226,1020,226,2302,202,718,226,2852,204,1316,188,1332,174,1618,204,1590,204,12320,204,1040,178,1342,176,746,226,748,224,796,176,2166,204,716,226,748,224\";\nvar voldown = \"228,1092,154,2302,206,716,228,2850,206,1314,176,1344,176,1618,206,1588,206,12318,206,1038,178,1206,176,794,178,796,178,794,178,2302,206,766,178,796,178\";\n\nvar youview = \"230,1040,208,2300,204,766,176,2850,206,1314,176,1344,176,1618,206,1588,206,12318,206,1038,178,2438,206,716,226,794,176,1070,178,746,226,796,178,794,178\";\nvar back = \"224,1070,178,2302,204,718,226,2852,204,1316,176,1344,174,1620,204,1588,204,12320,206,1040,176,1480,176,796,176,746,226,1020,224,1756,204,718,224,748,224\";\nvar close = \"224,1058,190,2302,204,768,176,2850,204,1316,200,1320,200,1594,202,1590,204,12318,204,1040,200,1594,204,764,204,772,176,1070,202,1592,204,768,176,796,176\";\n\nvar play = \"228,1020,228,2300,204,742,202,2848,206,1316,176,1344,176,1618,204,1588,206,12318,206,1040,176,2302,204,718,226,752,220,1206,176,746,226,796,176,794,176\";\nvar stop = \"226,1072,200,2278,202,720,224,2850,202,1318,200,1320,200,1592,202,1590,202,12320,204,1042,200,722,224,2030,202,720,224,1208,200,1046,200,764,182,798,200\";\nvar pause = \"228,1020,226,2302,202,720,224,2850,204,1318,198,1320,200,1594,204,1590,204,12320,204,1042,200,2142,202,756,188,748,224,1208,200,910,202,722,224,748,224\";\nvar rewind = \"228,1020,226,2302,204,716,228,2850,204,1316,200,1320,200,1594,204,1590,204,12318,204,1040,176,1892,204,718,226,746,226,1206,176,1208,174,748,224,748,224\";\nvar ff = \"226,1068,204,2278,202,720,224,2850,202,1318,198,1322,188,1606,204,1590,204,12318,204,1040,200,2688,204,2002,202,720,224,1208,176,1346,174,746,224,748,224\";\nvar skipback = \"196,1050,224,2308,202,720,224,2852,202,1316,176,1344,176,1618,204,1590,204,12316,232,1014,176,2712,204,1866,202,718,226,1206,176,1480,176,766,208,744,226\";\nvar skipfwd = \"196,1050,226,2306,204,716,226,2850,206,1318,178,1338,176,1618,204,1590,204,12318,206,1040,176,2576,204,1864,204,766,176,1206,176,1618,206,766,178,794,176\";\n\nvar code;\n\nswitch(msg.payload) {\n\n//=======STD CODES=======\ncase \"ON\":\n    code=on;\nbreak;\n\ncase \"OFF\":\n    code=on;\nbreak;\n\ncase \"VOL_UP\":\n    code=volup;\nbreak;\n\ncase \"VOL_DOWN\":\n    code=voldown;\nbreak;\n\ncase \"CHAN_UP\":\n    code=chanup;\nbreak;\n\ncase \"CHAN_DOWN\":\n    code=chandown;\nbreak;\n\ncase \"MUTE\":\n    code=mute;\nbreak;\n\ncase \"1\":\n    code=one;\nbreak;\n\ncase \"2\":\n    code=two;\nbreak;\n\ncase \"3\":\n    code=three;\nbreak;\n\ncase \"4\":\n    code=four;\nbreak;\n\ncase \"5\":\n    code=five;\nbreak;\n\ncase \"6\":\n    code=six;\nbreak;\n\ncase \"7\":\n    code=seven;\nbreak;\n\ncase \"8\":\n    code=eight;\nbreak;\n\ncase \"9\":\n    code=nine;\nbreak;\n\ncase \"0\":\n    code=zero;\nbreak;\n\ncase \"UP\":\n    code=up;\nbreak;\n\ncase \"DOWN\":\n    code=down;\nbreak;\n\ncase \"LEFT\":\n    code=left;\nbreak;\n\ncase \"OK\":\n    code=ok;\nbreak;\n\ncase \"RIGHT\":\n    code=right;\nbreak;\n\ncase \"MENU\":\n    code=menu;\nbreak;\n\ncase \"PLAY\":\n    code=play;\nbreak;\n\ncase \"PAUSE\":\n    code=pause;\nbreak;\n\ncase \"STOP\":\n    code=stop;\nbreak;\n\ncase \"REWIND\":\n    code=rewind;\nbreak;\n\ncase \"FASTFORWARD\":\n    code=ff;\nbreak;\n\ncase \"SKIPBACKWARD\":\n    code=skipback;\nbreak;\n\ncase \"SKIPFORWARD\":\n    code=skipfwd;\nbreak;\n\n//=======CUSTOM CODES=======\ncase \"YOUVIEW\":\n    code=youview;\nbreak;\n\ncase \"BACK\":\n    code=back;\nbreak;\n\ncase \"CLOSE\":\n    code=close;\nbreak;\n\n}\n    msg.payload = \"30,38,\"+code+\",\"+code+\",\"+code;\n    code=null;\n    \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 368.5,
        "y": 842,
        "wires": [
            [
                "df96765.bb9fc88",
                "26aad11e.83917e"
            ]
        ]
    },
    {
        "id": "26aad11e.83917e",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 570,
        "y": 880,
        "wires": []
    },
    {
        "id": "d05e2054.164d2",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "30,38,204,1042,176,2440,204,1864,204,716,226,796,176,2166,204,768,176,748,224",
        "payloadType": "str",
        "x": 370,
        "y": 440,
        "wires": [
            [
                "5c32750a.82e58c",
                "e0e8be95.461f1"
            ]
        ]
    },
    {
        "id": "4fe47c4b.9a6e34",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON - SAT",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 40,
        "wires": [
            [
                "25ce6ce2.557364"
            ]
        ]
    },
    {
        "id": "25ce6ce2.557364",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/media/sat/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 750,
        "y": 40,
        "wires": []
    },
    {
        "id": "a1122533.975ff8",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test YOUVIEW ON",
        "info": "",
        "x": 190,
        "y": 440,
        "wires": []
    },
    {
        "id": "e0e8be95.461f1",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 570,
        "y": 420,
        "wires": []
    },
    {
        "id": "5cc10525.d8073c",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 630,
        "y": 920,
        "wires": []
    },
    {
        "id": "710eaf20.c6669",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "Apple TV commands",
        "topic": "iot/media/apple-tv/set",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 180,
        "y": 960,
        "wires": [
            [
                "65516b93.a53444"
            ]
        ]
    },
    {
        "id": "65516b93.a53444",
        "type": "function",
        "z": "83b19753.1af4a8",
        "name": "Find IR Command",
        "func": "//YOUVIEW COMMANDS\n\nswitch(msg.payload) {\n\ncase \"MENU\":\n    msg.payload = \"25,R1,F413EB7\";\nbreak;\n\ncase \"PLUS\":\n    msg.payload = \"4,A90,0,1\";\nbreak;\n\ncase \"VOL_UP\":\n    msg.payload = \"4,490,0,1\";\nbreak;\n\ncase \"VOL_DOWN\":\n    msg.payload = \"4,C90,0,1\";\nbreak;\n\ncase \"CHAN_UP\":\n    msg.payload = \"4,090,0,1\";\nbreak;\n\ncase \"CHAN_DOWN\":\n    msg.payload = \"4,890,0,1\";\nbreak;\n\ncase \"MUTE\":\n    msg.payload = \"4,290,0,1\";\nbreak;\n\ncase \"1\":\n    msg.payload = \"4,010,0,1\";\nbreak;\n\ncase \"2\":\n    msg.payload = \"4,810,0,1\";\nbreak;\n\ncase \"3\":\n    msg.payload = \"4,410,0,1\";\nbreak;\n\ncase \"4\":\n    msg.payload = \"4,C10,0,1\";\nbreak;\n\ncase \"5\":\n    msg.payload = \"4,210,0,1\";\nbreak;\n\ncase \"6\":\n    msg.payload = \"4,A10,0,1\";\nbreak;\n\ncase \"7\":\n    msg.payload = \"4,610,0,1\";\nbreak;\n\ncase \"8\":\n    msg.payload = \"4,E10,0,1\";\nbreak;\n\ncase \"9\":\n    msg.payload = \"4,110,0,1\";\nbreak;\n\ncase \"0\":\n    msg.payload = \"4,910,0,1\";\nbreak;\n\ncase \"UP\":\n    msg.payload = \"4,2F0,0,1\";\nbreak;\n\ncase \"DOWN\":\n    msg.payload = \"4,AF0,0,1\";\nbreak;\n\ncase \"LEFT\":\n    msg.payload = \"4,2D0,0,1\";\nbreak;\n\ncase \"OK\":\n    msg.payload = \"4,A70,0,1\";\nbreak;\n\ncase \"RIGHT\":\n    msg.payload = \"4,CD0,0,1\";\nbreak;\n\ncase \"MENU\":\n    msg.payload = \"4,070,0,1\";\nbreak;\n    \n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 408.5,
        "y": 962,
        "wires": [
            [
                "5cc10525.d8073c",
                "ae4d7569.499bd8"
            ]
        ]
    },
    {
        "id": "ae4d7569.499bd8",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 610,
        "y": 1000,
        "wires": []
    },
    {
        "id": "e47d51e1.b051f",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "25,R1,0x000000000000403F",
        "payloadType": "str",
        "x": 370,
        "y": 480,
        "wires": [
            [
                "5c32750a.82e58c"
            ]
        ]
    },
    {
        "id": "9b7b3b6d.fad278",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test APPLE TV MENU",
        "info": "",
        "x": 180,
        "y": 480,
        "wires": []
    },
    {
        "id": "3130ac9b.da1914",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "Received IR commands",
        "topic": "iot/ircontroller/receive",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 200,
        "y": 1160,
        "wires": [
            [
                "abbc5bcb.18b2c8"
            ]
        ]
    },
    {
        "id": "abbc5bcb.18b2c8",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 420,
        "y": 1180,
        "wires": []
    },
    {
        "id": "ead1ecf.ccb031",
        "type": "mqtt in",
        "z": "83b19753.1af4a8",
        "name": "Received IR commands",
        "topic": "iot/ircontroller/receive/raw",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 200,
        "y": 1240,
        "wires": [
            [
                "fb369b87.046188"
            ]
        ]
    },
    {
        "id": "fb369b87.046188",
        "type": "debug",
        "z": "83b19753.1af4a8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 420,
        "y": 1260,
        "wires": []
    },
    {
        "id": "af119b4a.a3cb38",
        "type": "mqtt out",
        "z": "83b19753.1af4a8",
        "name": "",
        "topic": "iot/media/sat/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 830,
        "y": 1380,
        "wires": []
    },
    {
        "id": "1346dfa8.34242",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 190,
        "y": 1380,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "cc84113b.67e86",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "General Test",
        "info": "",
        "x": 70,
        "y": 1340,
        "wires": []
    },
    {
        "id": "29a8283b.98b4c8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "CHAN_DOWN",
        "payloadType": "str",
        "x": 210,
        "y": 1420,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "a6bba893.df0be8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "CHAN_UP",
        "payloadType": "str",
        "x": 200,
        "y": 1460,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "4696f8bc.9ce228",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "VOL_UP",
        "payloadType": "str",
        "x": 200,
        "y": 1500,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "914843bf.f4494",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "VOL_DOWN",
        "payloadType": "str",
        "x": 210,
        "y": 1540,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "de161370.89add",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "MUTE",
        "payloadType": "str",
        "x": 190,
        "y": 1580,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "6e535e46.f8935",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "LEFT",
        "payloadType": "str",
        "x": 190,
        "y": 1620,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "65918a4b.e027f4",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "RIGHT",
        "payloadType": "str",
        "x": 190,
        "y": 1660,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "f4b6f9f8.fa80a8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "UP",
        "payloadType": "str",
        "x": 190,
        "y": 1700,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "c07d03e0.34463",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "DOWN",
        "payloadType": "str",
        "x": 190,
        "y": 1740,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "f64a8eb2.00086",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 370,
        "y": 1380,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "d2b5294.36a4bd8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "OK",
        "payloadType": "str",
        "x": 370,
        "y": 1420,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "617986b6.06db88",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 370,
        "y": 1460,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "cb134511.ef1288",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "2",
        "payloadType": "str",
        "x": 370,
        "y": 1500,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "d084934d.f9f57",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "3",
        "payloadType": "str",
        "x": 370,
        "y": 1540,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "6e25a96f.34df88",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "4",
        "payloadType": "str",
        "x": 370,
        "y": 1580,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "71d402a0.4bfb1c",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "5",
        "payloadType": "str",
        "x": 370,
        "y": 1620,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "2a28eb2c.46c944",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "6",
        "payloadType": "str",
        "x": 370,
        "y": 1660,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "8cbe25aa.bf1568",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "7",
        "payloadType": "str",
        "x": 370,
        "y": 1700,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "6a1c8df6.8a5724",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "8",
        "payloadType": "str",
        "x": 370,
        "y": 1740,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "690ba0f9.ab244",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "9",
        "payloadType": "str",
        "x": 530,
        "y": 1380,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "a7554cc4.0b166",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "0",
        "payloadType": "str",
        "x": 530,
        "y": 1420,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "f7d18771.97e548",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "PLAY",
        "payloadType": "str",
        "x": 530,
        "y": 1460,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "2214d465.a561cc",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "PAUSE",
        "payloadType": "str",
        "x": 530,
        "y": 1500,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "d89e66a7.2ce298",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "STOP",
        "payloadType": "str",
        "x": 530,
        "y": 1540,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "fcc3248c.daf5e8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "REWIND",
        "payloadType": "str",
        "x": 540,
        "y": 1580,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "cae48cae.602f1",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "FASTFORWARD",
        "payloadType": "str",
        "x": 560,
        "y": 1620,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "40d964de.11521c",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "SKIPBACKWARD",
        "payloadType": "str",
        "x": 560,
        "y": 1660,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "f28aaef4.36fb8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "SKIPFORWARD",
        "payloadType": "str",
        "x": 560,
        "y": 1700,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "e6585216.cc8bf",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "YOUVIEW",
        "payloadType": "str",
        "x": 360,
        "y": 1800,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "a86e26fa.02a4c8",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "BACK",
        "payloadType": "str",
        "x": 350,
        "y": 1840,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "264fbad0.1f5df6",
        "type": "inject",
        "z": "83b19753.1af4a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "CLOSE",
        "payloadType": "str",
        "x": 350,
        "y": 1880,
        "wires": [
            [
                "af119b4a.a3cb38"
            ]
        ]
    },
    {
        "id": "f982754d.c197e8",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Youview Custom Test",
        "info": "",
        "x": 100,
        "y": 1800,
        "wires": []
    },
    {
        "id": "3f429baa.b36a04",
        "type": "mqtt out",
        "z": "7d076915.bef778",
        "name": "",
        "topic": "localgateway_to_awsiot",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 590,
        "y": 80,
        "wires": []
    },
    {
        "id": "4375eb2b.46c624",
        "type": "inject",
        "z": "7d076915.bef778",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "hello from pi!",
        "payloadType": "str",
        "x": 250,
        "y": 120,
        "wires": [
            [
                "3f429baa.b36a04",
                "10751fd4.a34e6"
            ]
        ]
    },
    {
        "id": "10751fd4.a34e6",
        "type": "debug",
        "z": "7d076915.bef778",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 490,
        "y": 160,
        "wires": []
    },
    {
        "id": "83caf790.f3f178",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/set",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 210,
        "y": 60,
        "wires": [
            [
                "2e8f00ec.41108",
                "a52eee52.16893"
            ]
        ]
    },
    {
        "id": "2e8f00ec.41108",
        "type": "debug",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 660,
        "y": 140,
        "wires": []
    },
    {
        "id": "de12c2f6.b9a7c",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/set",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 620,
        "y": 240,
        "wires": []
    },
    {
        "id": "28002cd0.2ac184",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "120",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 310,
        "y": 240,
        "wires": [
            [
                "de12c2f6.b9a7c",
                "a52eee52.16893"
            ]
        ]
    },
    {
        "id": "a52eee52.16893",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 620,
        "y": 300,
        "wires": []
    },
    {
        "id": "2f1c6fea.0adf5",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "150",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 310,
        "y": 300,
        "wires": [
            [
                "a52eee52.16893",
                "de12c2f6.b9a7c"
            ]
        ]
    },
    {
        "id": "45ded5ce.05fb9c",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "offline",
        "payloadType": "str",
        "x": 290,
        "y": 440,
        "wires": [
            [
                "35fae5c6.3e0d3a"
            ]
        ]
    },
    {
        "id": "929e5f9d.f4915",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "online",
        "payloadType": "str",
        "x": 290,
        "y": 380,
        "wires": [
            [
                "35fae5c6.3e0d3a"
            ]
        ]
    },
    {
        "id": "35fae5c6.3e0d3a",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/available",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 610,
        "y": 380,
        "wires": []
    },
    {
        "id": "158fe0e1.051f5f",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/state",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 220,
        "y": 100,
        "wires": [
            [
                "2e8f00ec.41108"
            ]
        ]
    },
    {
        "id": "cb680a3f.68cbe8",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/living-room/lights/ceiling/available",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 230,
        "y": 140,
        "wires": [
            [
                "2e8f00ec.41108"
            ]
        ]
    },
    {
        "id": "5fce6f32.cae3c",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/set",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 210,
        "y": 520,
        "wires": [
            [
                "ed66ac4b.eac03",
                "769692d0.9cbd8c"
            ]
        ]
    },
    {
        "id": "ed66ac4b.eac03",
        "type": "debug",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 660,
        "y": 600,
        "wires": []
    },
    {
        "id": "9652004a.5ee2b",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/set",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 620,
        "y": 700,
        "wires": []
    },
    {
        "id": "88cd37e8.6a7f78",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "120",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 310,
        "y": 700,
        "wires": [
            [
                "9652004a.5ee2b",
                "769692d0.9cbd8c"
            ]
        ]
    },
    {
        "id": "769692d0.9cbd8c",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 620,
        "y": 760,
        "wires": []
    },
    {
        "id": "14545ff.3bfaaa",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "150",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 310,
        "y": 760,
        "wires": [
            [
                "769692d0.9cbd8c",
                "9652004a.5ee2b"
            ]
        ]
    },
    {
        "id": "4fc84070.e7912",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "offline",
        "payloadType": "str",
        "x": 290,
        "y": 900,
        "wires": [
            [
                "265fa910.114e16"
            ]
        ]
    },
    {
        "id": "ee0c6f41.148ec",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "online",
        "payloadType": "str",
        "x": 290,
        "y": 840,
        "wires": [
            [
                "265fa910.114e16"
            ]
        ]
    },
    {
        "id": "265fa910.114e16",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/available",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 620,
        "y": 840,
        "wires": []
    },
    {
        "id": "1f0ed7af.9bdca8",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/state",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 220,
        "y": 560,
        "wires": [
            [
                "ed66ac4b.eac03"
            ]
        ]
    },
    {
        "id": "8805864.99f4778",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/dining-room/lights/ceiling/available",
        "qos": "2",
        "broker": "b113ebbe.a57308",
        "x": 230,
        "y": 600,
        "wires": [
            [
                "ed66ac4b.eac03"
            ]
        ]
    },
    {
        "id": "f35e123b.b2ea3",
        "type": "mqtt out",
        "z": "9abde8e2.4b7518",
        "name": "",
        "topic": "/hello",
        "qos": "1",
        "retain": "false",
        "broker": "b113ebbe.a57308",
        "x": 330,
        "y": 100,
        "wires": []
    },
    {
        "id": "bef08228.e5a57",
        "type": "inject",
        "z": "9abde8e2.4b7518",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 100,
        "wires": [
            [
                "f35e123b.b2ea3"
            ]
        ]
    },
    {
        "id": "4b703ca6.530954",
        "type": "comment",
        "z": "83b19753.1af4a8",
        "name": "Test Comment",
        "info": "",
        "x": 320,
        "y": 220,
        "wires": []
    },
    {
        "id": "8c3e1476.0259a8",
        "type": "debug",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 620,
        "y": 1060,
        "wires": []
    },
    {
        "id": "68a92931.643398",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 560,
        "y": 1200,
        "wires": []
    },
    {
        "id": "a4fd4a81.2f0dd8",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "120",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 270,
        "y": 1160,
        "wires": [
            [
                "68a92931.643398",
                "6471a94d.39fae8"
            ]
        ]
    },
    {
        "id": "e023d8ce.73d058",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "150",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 270,
        "y": 1220,
        "wires": [
            [
                "68a92931.643398",
                "6471a94d.39fae8"
            ]
        ]
    },
    {
        "id": "7c3b4d80.638424",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "offline",
        "payloadType": "str",
        "x": 250,
        "y": 1360,
        "wires": [
            [
                "5a6b9a63.95cf64"
            ]
        ]
    },
    {
        "id": "1728ff17.492061",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "online",
        "payloadType": "str",
        "x": 250,
        "y": 1300,
        "wires": [
            [
                "5a6b9a63.95cf64"
            ]
        ]
    },
    {
        "id": "5a6b9a63.95cf64",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/available",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 550,
        "y": 1300,
        "wires": []
    },
    {
        "id": "e633f956.fb4128",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 150,
        "y": 1020,
        "wires": [
            [
                "8c3e1476.0259a8"
            ]
        ]
    },
    {
        "id": "95ad7a.9a8b0288",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/available",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 160,
        "y": 1060,
        "wires": [
            [
                "8c3e1476.0259a8"
            ]
        ]
    },
    {
        "id": "b55be28b.9cb49",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 150,
        "y": 980,
        "wires": [
            [
                "68a92931.643398",
                "8c3e1476.0259a8"
            ]
        ]
    },
    {
        "id": "6471a94d.39fae8",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/lights/set",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 550,
        "y": 1140,
        "wires": []
    },
    {
        "id": "2505a2a2.cb1a3e",
        "type": "debug",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 610,
        "y": 1440,
        "wires": []
    },
    {
        "id": "ddc8159a.475b38",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 1660,
        "wires": [
            [
                "4db268df.d06618"
            ]
        ]
    },
    {
        "id": "971b3381.bc192",
        "type": "debug",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 630,
        "y": 1860,
        "wires": []
    },
    {
        "id": "bf69059c.fa42b8",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/opening_1/state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 580,
        "y": 2000,
        "wires": []
    },
    {
        "id": "f7ca8fbf.7990d",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "120",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 280,
        "y": 1960,
        "wires": [
            [
                "bf69059c.fa42b8"
            ]
        ]
    },
    {
        "id": "40649412.4e101c",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "150",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 280,
        "y": 2020,
        "wires": [
            [
                "bf69059c.fa42b8"
            ]
        ]
    },
    {
        "id": "f8b9f71.3c32908",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "offline",
        "payloadType": "str",
        "x": 260,
        "y": 2160,
        "wires": [
            [
                "67e5411f.a4852"
            ]
        ]
    },
    {
        "id": "e7e89f50.277ee",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "online",
        "payloadType": "str",
        "x": 260,
        "y": 2100,
        "wires": [
            [
                "67e5411f.a4852"
            ]
        ]
    },
    {
        "id": "67e5411f.a4852",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/opening_1/available",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 570,
        "y": 2100,
        "wires": []
    },
    {
        "id": "c612248c.796388",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/opening_1/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 180,
        "y": 1820,
        "wires": [
            [
                "971b3381.bc192"
            ]
        ]
    },
    {
        "id": "95846869.5135f8",
        "type": "mqtt in",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/opening_1/available",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 190,
        "y": 1860,
        "wires": [
            [
                "971b3381.bc192"
            ]
        ]
    },
    {
        "id": "6145c04e.94cd1",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "21",
        "payloadType": "num",
        "x": 230,
        "y": 2260,
        "wires": [
            [
                "dceee275.c69cb"
            ]
        ]
    },
    {
        "id": "dceee275.c69cb",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/temperature",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 560,
        "y": 2260,
        "wires": []
    },
    {
        "id": "3a3b5897.79aef8",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "16",
        "payloadType": "num",
        "x": 230,
        "y": 2320,
        "wires": [
            [
                "dceee275.c69cb"
            ]
        ]
    },
    {
        "id": "646355.ff1fdcac",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "test.home/test_room/humidity",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 550,
        "y": 2380,
        "wires": []
    },
    {
        "id": "fb1bda50.b12628",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "50",
        "payloadType": "num",
        "x": 230,
        "y": 2380,
        "wires": [
            [
                "646355.ff1fdcac"
            ]
        ]
    },
    {
        "id": "20eefdb8.018362",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "25",
        "payloadType": "num",
        "x": 230,
        "y": 2440,
        "wires": [
            [
                "646355.ff1fdcac"
            ]
        ]
    },
    {
        "id": "b322fe2.12244",
        "type": "mqtt in",
        "z": "9abde8e2.4b7518",
        "name": "",
        "topic": "#",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 160,
        "y": 220,
        "wires": [
            [
                "98e2af6d.7e382"
            ]
        ]
    },
    {
        "id": "98e2af6d.7e382",
        "type": "debug",
        "z": "9abde8e2.4b7518",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 340,
        "y": 220,
        "wires": []
    },
    {
        "id": "fcbe5092.452ff",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "Downstairs B'room Window Closed",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/RESULT",
        "payload": "{\"RfReceived\":{\"Sync\":14100,\"Low\":490,\"High\":1380,\"Data\":\"E1990E\",\"RfKey\":\"None\"}}",
        "payloadType": "json",
        "x": 300,
        "y": 2580,
        "wires": [
            [
                "69002387.afbc1c"
            ]
        ]
    },
    {
        "id": "41bd18fe.715028",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "Downstairs B'room Window Open",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/RESULT",
        "payload": "{\"RfReceived\":{\"Sync\":14100,\"Low\":490,\"High\":1380,\"Data\":\"E1990A\",\"RfKey\":\"None\"}}",
        "payloadType": "json",
        "x": 300,
        "y": 2540,
        "wires": [
            [
                "69002387.afbc1c"
            ]
        ]
    },
    {
        "id": "7121ca2a.dce774",
        "type": "inject",
        "z": "ecafbd20.fc3e8",
        "name": "RF Bridge Status",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/STATE",
        "payload": "{\"Time\":\"2019-09-17T21:39:32\",\"Uptime\":\"0T00:15:18\",\"Heap\":15,\"SleepMode\":\"Dynamic\",\"Sleep\":50,\"LoadAvg\":19,\"Wifi\":{\"AP\":1,\"SSId\":\"PrettyFlyForAWifi\",\"BSSId\":\"18:D2:76:D0:9C:FC\",\"Channel\":11,\"RSSI\":100,\"LinkCount\":1,\"Downtime\":\"0T00:00:06\"}}",
        "payloadType": "json",
        "x": 240,
        "y": 2620,
        "wires": [
            [
                "69002387.afbc1c"
            ]
        ]
    },
    {
        "id": "69002387.afbc1c",
        "type": "mqtt out",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 580,
        "y": 2580,
        "wires": []
    },
    {
        "id": "3848870b.56ea58",
        "type": "inject",
        "z": "180daee1.f8c5a1",
        "name": "Downstairs B'room Window Closed",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/RESULT",
        "payload": "{\"RfReceived\":{\"Sync\":14100,\"Low\":490,\"High\":1380,\"Data\":\"E1990E\",\"RfKey\":\"None\"}}",
        "payloadType": "json",
        "x": 300,
        "y": 160,
        "wires": [
            [
                "292ec6b2.601fea"
            ]
        ]
    },
    {
        "id": "2f01cf99.e5f25",
        "type": "inject",
        "z": "180daee1.f8c5a1",
        "name": "Downstairs B'room Window Open",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/RESULT",
        "payload": "{\"RfReceived\":{\"Sync\":14100,\"Low\":490,\"High\":1380,\"Data\":\"E1990A\",\"RfKey\":\"None\"}}",
        "payloadType": "json",
        "x": 300,
        "y": 120,
        "wires": [
            [
                "292ec6b2.601fea"
            ]
        ]
    },
    {
        "id": "5eeb9693.e6bfb8",
        "type": "inject",
        "z": "180daee1.f8c5a1",
        "name": "RF Bridge Status",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tele/sonoff-rf-bridge/STATE",
        "payload": "{\"Time\":\"2019-09-17T21:39:32\",\"Uptime\":\"0T00:15:18\",\"Heap\":15,\"SleepMode\":\"Dynamic\",\"Sleep\":50,\"LoadAvg\":19,\"Wifi\":{\"AP\":1,\"SSId\":\"PrettyFlyForAWifi\",\"BSSId\":\"18:D2:76:D0:9C:FC\",\"Channel\":11,\"RSSI\":100,\"LinkCount\":1,\"Downtime\":\"0T00:00:06\"}}",
        "payloadType": "json",
        "x": 240,
        "y": 200,
        "wires": [
            [
                "292ec6b2.601fea"
            ]
        ]
    },
    {
        "id": "292ec6b2.601fea",
        "type": "mqtt out",
        "z": "180daee1.f8c5a1",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 580,
        "y": 160,
        "wires": []
    },
    {
        "id": "44b453c8.a1058c",
        "type": "comment",
        "z": "7c38d180.0695d",
        "name": "Sonoff RF Status - Device Timeout",
        "info": "",
        "x": 180,
        "y": 40,
        "wires": []
    },
    {
        "id": "853c4c04.23f08",
        "type": "mqtt in",
        "z": "7c38d180.0695d",
        "name": "",
        "topic": "tele/sonoff-rf-bridge/STATE",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 140,
        "y": 120,
        "wires": [
            [
                "4ab1ad9c.461fb4",
                "4473e23d.5e7e2c",
                "ca32fe51.eb2e8"
            ]
        ]
    },
    {
        "id": "d973df75.e4044",
        "type": "mqtt out",
        "z": "7c38d180.0695d",
        "name": "",
        "topic": "tele/sonoff-rf-bridge/device/state",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 840,
        "y": 220,
        "wires": []
    },
    {
        "id": "2ec7267f.beac4a",
        "type": "template",
        "z": "7c38d180.0695d",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "plain",
        "template": "unavailable",
        "output": "str",
        "x": 580,
        "y": 280,
        "wires": [
            [
                "d973df75.e4044"
            ]
        ]
    },
    {
        "id": "ffb156cc.75a8b8",
        "type": "inject",
        "z": "7c38d180.0695d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 280,
        "wires": [
            [
                "2ec7267f.beac4a",
                "faf0aa48.e91bc8"
            ]
        ]
    },
    {
        "id": "4473e23d.5e7e2c",
        "type": "template",
        "z": "7c38d180.0695d",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "plain",
        "template": "available",
        "output": "str",
        "x": 580,
        "y": 60,
        "wires": [
            [
                "d973df75.e4044"
            ]
        ]
    },
    {
        "id": "9affa131.e50c2",
        "type": "inject",
        "z": "7c38d180.0695d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 60,
        "wires": [
            [
                "4473e23d.5e7e2c",
                "ca32fe51.eb2e8"
            ]
        ]
    },
    {
        "id": "b0c0d5af.f51a88",
        "type": "debug",
        "z": "7c38d180.0695d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 770,
        "y": 100,
        "wires": []
    },
    {
        "id": "40b7c5eb.d89c1c",
        "type": "inject",
        "z": "7c38d180.0695d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 180,
        "wires": [
            [
                "4ab1ad9c.461fb4"
            ]
        ]
    },
    {
        "id": "faf0aa48.e91bc8",
        "type": "template",
        "z": "7c38d180.0695d",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "plain",
        "template": "off",
        "output": "str",
        "x": 580,
        "y": 240,
        "wires": [
            [
                "d973df75.e4044"
            ]
        ]
    },
    {
        "id": "ca32fe51.eb2e8",
        "type": "template",
        "z": "7c38d180.0695d",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "plain",
        "template": "on",
        "output": "str",
        "x": 580,
        "y": 100,
        "wires": [
            [
                "d973df75.e4044"
            ]
        ]
    },
    {
        "id": "865fc24c.28ca5",
        "type": "mqtt in",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/tele/heating/ufh/sonoff",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "3c5bfd1c.a80492"
            ]
        ]
    },
    {
        "id": "3c5bfd1c.a80492",
        "type": "debug",
        "z": "53b9a091.ecbea",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 390,
        "y": 180,
        "wires": []
    },
    {
        "id": "41c5a9e.c6d7958",
        "type": "debug",
        "z": "53b9a091.ecbea",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 630,
        "y": 40,
        "wires": []
    },
    {
        "id": "ac0d91df.07286",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/tele/heating/ufh/sonoff",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 720,
        "y": 80,
        "wires": []
    },
    {
        "id": "43405df5.d38264",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/tele/heating/ufh/sonoff",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 380,
        "y": 260,
        "wires": []
    },
    {
        "id": "f350ccb7.84cec",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 130,
        "y": 260,
        "wires": [
            [
                "43405df5.d38264"
            ]
        ]
    },
    {
        "id": "dbcf7423.e4f918",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 130,
        "y": 300,
        "wires": [
            [
                "43405df5.d38264"
            ]
        ]
    },
    {
        "id": "fe465250.5ab3d",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Test Inject State OFF",
        "repeat": "30",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"Time\":\"2019-11-03T20:43:45\",\"Uptime\":\"2T21:43:04\",\"Heap\":14,\"SleepMode\":\"Dynamic\",\"Sleep\":50,\"LoadAvg\":23,\"POWER\":\"OFF\",\"Wifi\":{\"AP\":1,\"SSId\":\"PrettyFlyForAWifi\",\"BSSId\":\"18:E8:29:FB:44:9C\",\"Channel\":1,\"RSSI\":32,\"LinkCount\":4,\"Downtime\":\"0T00:02:44\"}}",
        "payloadType": "json",
        "x": 140,
        "y": 400,
        "wires": [
            [
                "e6b069ed.af2fd8"
            ]
        ]
    },
    {
        "id": "e6b069ed.af2fd8",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/tele/heating/ufh/sonoff/STATE",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 420,
        "y": 420,
        "wires": []
    },
    {
        "id": "1308026a.005cee",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "TEST/heating/ufh/temperature",
        "payload": "23",
        "payloadType": "num",
        "x": 210,
        "y": 500,
        "wires": [
            [
                "21baffe9.2eca1"
            ]
        ]
    },
    {
        "id": "21baffe9.2eca1",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/heating/ufh/temperature",
        "qos": "0",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 540,
        "y": 500,
        "wires": []
    },
    {
        "id": "9927f4e2.0748f8",
        "type": "mqtt in",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/heating/ufh/currentsetpoint/command",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 230,
        "y": 580,
        "wires": [
            [
                "3b0b0de5.6a2a92"
            ]
        ]
    },
    {
        "id": "3b0b0de5.6a2a92",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "TEST/heating/ufh/currentsetpoint",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 580,
        "y": 580,
        "wires": []
    },
    {
        "id": "30ca452.b0bc2ba",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Test Inject State ON",
        "repeat": "30",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"Time\":\"2019-11-03T20:43:45\",\"Uptime\":\"2T21:43:04\",\"Heap\":14,\"SleepMode\":\"Dynamic\",\"Sleep\":50,\"LoadAvg\":23,\"POWER\":\"ON\",\"Wifi\":{\"AP\":1,\"SSId\":\"PrettyFlyForAWifi\",\"BSSId\":\"18:E8:29:FB:44:9C\",\"Channel\":1,\"RSSI\":32,\"LinkCount\":4,\"Downtime\":\"0T00:02:44\"}}",
        "payloadType": "json",
        "x": 140,
        "y": 440,
        "wires": [
            [
                "e6b069ed.af2fd8"
            ]
        ]
    },
    {
        "id": "fb1766f.7831898",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "cmnd/heating/ufh/sonoff/power",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 930,
        "y": 760,
        "wires": []
    },
    {
        "id": "46b694de.9e0cfc",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "setCurrent",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 720,
        "wires": [
            [
                "8abeb326.25832"
            ]
        ]
    },
    {
        "id": "fba630c7.40439",
        "type": "switch",
        "z": "53b9a091.ecbea",
        "name": "Route result",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 760,
        "wires": [
            [
                "25fae2d4.1ff63e"
            ],
            [
                "42f1fd83.a3a854"
            ]
        ]
    },
    {
        "id": "25fae2d4.1ff63e",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "Set ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 720,
        "wires": [
            [
                "fb1766f.7831898"
            ]
        ]
    },
    {
        "id": "42f1fd83.a3a854",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "Set OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 800,
        "wires": [
            [
                "fb1766f.7831898",
                "12661a7e.9bdcc6"
            ]
        ]
    },
    {
        "id": "5f06c0f5.0bf84",
        "type": "switch",
        "z": "91083d3a.54dc1",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 290,
        "y": 100,
        "wires": [
            [
                "24f84f0e.b20eb"
            ],
            [
                "6d6729a5.7ebe38"
            ]
        ]
    },
    {
        "id": "9397ba04.10e908",
        "type": "inject",
        "z": "91083d3a.54dc1",
        "name": "Scan Interval",
        "repeat": "180",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 280,
        "y": 40,
        "wires": [
            [
                "24f84f0e.b20eb"
            ]
        ]
    },
    {
        "id": "6d6729a5.7ebe38",
        "type": "debug",
        "z": "91083d3a.54dc1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 790,
        "y": 180,
        "wires": []
    },
    {
        "id": "b2a9e3e9.2b683",
        "type": "inject",
        "z": "91083d3a.54dc1",
        "name": "Toggle input_boolean",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 140,
        "y": 220,
        "wires": [
            [
                "f220107.74405f"
            ]
        ]
    },
    {
        "id": "8693686c.22f408",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 90,
        "y": 340,
        "wires": [
            [
                "43405df5.d38264"
            ]
        ]
    },
    {
        "id": "9d1b6e5.315cd9",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ch/currentsetpoint",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 900,
        "y": 1100,
        "wires": []
    },
    {
        "id": "fed651de.a355b",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Regular Update",
        "repeat": "300",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "12",
        "payloadType": "num",
        "x": 130,
        "y": 940,
        "wires": [
            [
                "45f80775.8a3b78"
            ]
        ]
    },
    {
        "id": "ec015861.fe7d68",
        "type": "debug",
        "z": "53b9a091.ecbea",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 850,
        "y": 1040,
        "wires": []
    },
    {
        "id": "2e91f837.45dee8",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ch/power_command",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 910,
        "y": 880,
        "wires": []
    },
    {
        "id": "a3b341c.2ab80c",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "Change Boolean to ON/OFF",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "ON",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "OFF",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 920,
        "wires": [
            [
                "2e91f837.45dee8",
                "ec015861.fe7d68"
            ]
        ]
    },
    {
        "id": "bc875e78.77c6",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Set Weekday Profile",
        "repeat": "",
        "crontab": "01 00 * * 1,2,3,4,5",
        "once": false,
        "onceDelay": 0.1,
        "topic": "setProfile",
        "payload": "Central Heating Timer (Weekday)",
        "payloadType": "str",
        "x": 140,
        "y": 1000,
        "wires": [
            [
                "45f80775.8a3b78"
            ]
        ]
    },
    {
        "id": "32b0fd02.efa442",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Set Weekend Profile",
        "repeat": "",
        "crontab": "01 00 * * 6,0",
        "once": false,
        "onceDelay": 0.1,
        "topic": "setProfile",
        "payload": "Central Heating Timer (Weekend)",
        "payloadType": "str",
        "x": 140,
        "y": 1040,
        "wires": [
            [
                "45f80775.8a3b78"
            ]
        ]
    },
    {
        "id": "5a71a862.ad98e8",
        "type": "comment",
        "z": "53b9a091.ecbea",
        "name": "Flow to mimic thermostat",
        "info": "",
        "x": 130,
        "y": 900,
        "wires": []
    },
    {
        "id": "2a8dfd7b.70bed2",
        "type": "delay",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 780,
        "y": 620,
        "wires": [
            [
                "41627a10.e348f4"
            ]
        ]
    },
    {
        "id": "c6817a46.06d288",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 520,
        "y": 840,
        "wires": [
            [
                "42f1fd83.a3a854"
            ]
        ]
    },
    {
        "id": "485bccb6.41c044",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 500,
        "y": 700,
        "wires": [
            [
                "25fae2d4.1ff63e"
            ]
        ]
    },
    {
        "id": "12661a7e.9bdcc6",
        "type": "debug",
        "z": "53b9a091.ecbea",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 920,
        "y": 820,
        "wires": []
    },
    {
        "id": "42f710ea.d84cc",
        "type": "delay",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 750,
        "y": 300,
        "wires": [
            [
                "ebc5f23d.2a8c58"
            ]
        ]
    },
    {
        "id": "9fcbb93a.60f3e8",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "Change Boolean to 25/0",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "23.0",
                "tot": "num"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "0.0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1060,
        "wires": [
            [
                "9d1b6e5.315cd9",
                "ec015861.fe7d68"
            ]
        ]
    },
    {
        "id": "87204e2e.e2d5d",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ch/mode_state",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 950,
        "y": 980,
        "wires": []
    },
    {
        "id": "f38fa315.6cee68",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ufh/temperature",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 530,
        "y": 1200,
        "wires": []
    },
    {
        "id": "2162de45.c73362",
        "type": "comment",
        "z": "53b9a091.ecbea",
        "name": "Use temp sensors for climate",
        "info": "",
        "x": 160,
        "y": 1140,
        "wires": []
    },
    {
        "id": "39dc68c5.ebc968",
        "type": "debug",
        "z": "53b9a091.ecbea",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 490,
        "y": 1160,
        "wires": []
    },
    {
        "id": "5667dbab.ac3724",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ch/temperature",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 510,
        "y": 1280,
        "wires": []
    },
    {
        "id": "563459e7.d0342",
        "type": "change",
        "z": "53b9a091.ecbea",
        "name": "Change Boolean to Heat/auto",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "heat",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "auto",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 960,
        "wires": [
            [
                "87204e2e.e2d5d"
            ]
        ]
    },
    {
        "id": "870a43c1.1c5ae8",
        "type": "inject",
        "z": "7c38d180.0695d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 80,
        "y": 340,
        "wires": [
            [
                "55a0f17f.6e6258"
            ]
        ]
    },
    {
        "id": "ab98181e.2b52b8",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1040,
        "y": 280,
        "wires": [
            [
                "8b60a3d5.c0d7"
            ]
        ]
    },
    {
        "id": "17f47fec.e7a7e",
        "type": "debug",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1590,
        "y": 460,
        "wires": []
    },
    {
        "id": "c3c895f0.960588",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1040,
        "y": 440,
        "wires": [
            [
                "f4e49553.2e7fd8"
            ]
        ]
    },
    {
        "id": "568849a1.61f218",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "Manual Trigger",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1040,
        "y": 760,
        "wires": [
            [
                "bcc89a41.7295a8"
            ]
        ]
    },
    {
        "id": "bcc89a41.7295a8",
        "type": "function",
        "z": "3ab1b3d8.bd433c",
        "name": "Create connect msg",
        "func": "var d = new Date();\nvar h = d.getHours();\nvar m = d.getMinutes();\nvar msgtext = \"The BLE hub was connected at \" + h + \":\" + m;\nmsg.payload = msgtext\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1260,
        "y": 720,
        "wires": [
            [
                "ec189c0c.c45d2",
                "ab472dd0.cfb83",
                "af62efff.b620d"
            ]
        ]
    },
    {
        "id": "ec189c0c.c45d2",
        "type": "debug",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1570,
        "y": 780,
        "wires": []
    },
    {
        "id": "1d381e33.1e8422",
        "type": "function",
        "z": "3ab1b3d8.bd433c",
        "name": "Create disconnect msg",
        "func": "var d = new Date();\nvar h = d.getHours();\nvar m = d.getMinutes() - 3;\nvar msgtext = \"The BLE hub was disconnected at \" + h + \":\" + m;\nmsg.payload = msgtext\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1250,
        "y": 660,
        "wires": [
            [
                "ec189c0c.c45d2",
                "ab472dd0.cfb83",
                "af62efff.b620d"
            ]
        ]
    },
    {
        "id": "a741bc22.d6683",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "Manual Trigger",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1040,
        "y": 600,
        "wires": [
            [
                "1d381e33.1e8422"
            ]
        ]
    },
    {
        "id": "b7e8568c.e86878",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "60",
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 310,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "f6b6f8f3.e10b98",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "Set Advance Profile (til 22:30)",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "setProfile",
        "payload": "Fully on til 22:30",
        "payloadType": "str",
        "x": 160,
        "y": 1080,
        "wires": [
            [
                "45f80775.8a3b78"
            ]
        ]
    },
    {
        "id": "33370902.6217d6",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 390,
        "y": 1120,
        "wires": [
            [
                "9fcbb93a.60f3e8"
            ]
        ]
    },
    {
        "id": "94311799.f33bb8",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "19.0",
        "payloadType": "num",
        "x": 310,
        "y": 1340,
        "wires": [
            [
                "5667dbab.ac3724",
                "f38fa315.6cee68"
            ]
        ]
    },
    {
        "id": "33d872c3.87156e",
        "type": "mqtt out",
        "z": "53b9a091.ecbea",
        "name": "",
        "topic": "/heating/ufh/currentsetpoint",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 920,
        "y": 1200,
        "wires": []
    },
    {
        "id": "3dbdd8c.0ca5928",
        "type": "inject",
        "z": "53b9a091.ecbea",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "22.0",
        "payloadType": "num",
        "x": 710,
        "y": 1180,
        "wires": [
            [
                "33d872c3.87156e"
            ]
        ]
    },
    {
        "id": "8b60a3d5.c0d7",
        "type": "function",
        "z": "3ab1b3d8.bd433c",
        "name": "Create disconnect msg",
        "func": "var d = new Date();\nvar h = d.getHours();\nvar m = d.getMinutes() - 3;\nvar msgtext = \"The Sonoff RF hub was disconnected at \" + h + \":\" + m;\nmsg.payload = msgtext\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1310,
        "y": 320,
        "wires": [
            [
                "a929f9ff.f2ff8",
                "bf61d608.6abff",
                "17f47fec.e7a7e"
            ]
        ]
    },
    {
        "id": "f4e49553.2e7fd8",
        "type": "function",
        "z": "3ab1b3d8.bd433c",
        "name": "Create connect msg",
        "func": "var d = new Date();\nvar h = d.getHours();\nvar m = d.getMinutes();\nvar msgtext = \"The Sonoff RF hub was connected at \" + h + \":\" + m;\nmsg.payload = msgtext\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1320,
        "y": 380,
        "wires": [
            [
                "a929f9ff.f2ff8",
                "bf61d608.6abff",
                "17f47fec.e7a7e"
            ]
        ]
    },
    {
        "id": "5134b02.ca52d5",
        "type": "inject",
        "z": "3ab1b3d8.bd433c",
        "name": "",
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "60",
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 710,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "268a47b3.b1184",
        "type": "inject",
        "z": "91083d3a.54dc1",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 80,
        "y": 320,
        "wires": [
            [
                "6b7f84ca.ab29bc"
            ]
        ]
    },
    {
        "id": "1331bfc1.27a2b",
        "type": "mqtt out",
        "z": "aeb6abf8.6695",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 610,
        "y": 120,
        "wires": []
    },
    {
        "id": "d26b557e.efac18",
        "type": "debug",
        "z": "aeb6abf8.6695",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 630,
        "y": 180,
        "wires": []
    },
    {
        "id": "a8a0835e.6b82",
        "type": "comment",
        "z": "aeb6abf8.6695",
        "name": "Test Xmas Lights On",
        "info": "",
        "x": 170,
        "y": 80,
        "wires": []
    },
    {
        "id": "58dc6d6.f6b9994",
        "type": "inject",
        "z": "aeb6abf8.6695",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "3,FFA25D,32",
        "payloadType": "str",
        "x": 330,
        "y": 160,
        "wires": [
            [
                "1331bfc1.27a2b",
                "d26b557e.efac18"
            ]
        ]
    },
    {
        "id": "be707752.3d2ad8",
        "type": "inject",
        "z": "aeb6abf8.6695",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "30,3800,9108,4514,544,586,546,586,546,586,546,586,546,586,546,586,546,588,544,586,546,1686,546,1706,526,1686,546,1688,546,1686,544,1686,546,1684,546,1686,546,1686,548,534,596,1686,546,586,546,586,546,586,546,1708",
        "payloadType": "str",
        "x": 350,
        "y": 120,
        "wires": [
            [
                "d26b557e.efac18",
                "1331bfc1.27a2b"
            ]
        ]
    },
    {
        "id": "2d5d9c42.d6b144",
        "type": "mqtt in",
        "z": "aeb6abf8.6695",
        "name": "Xmas Lights commands",
        "topic": "iot/christmas_lights/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 230,
        "y": 300,
        "wires": [
            [
                "3d70fc5e.d818b4"
            ]
        ]
    },
    {
        "id": "3d70fc5e.d818b4",
        "type": "function",
        "z": "aeb6abf8.6695",
        "name": "Find IR Command",
        "func": "//XMAS LIGHTS TV COMMANDS\n\nswitch(msg.payload) {\n\ncase \"ON\":\n    msg.payload = \"3,FFA25D\";\nbreak;\n\ncase \"OFF\":\n    msg.payload = \"3,FFA25D\";\nbreak;\n\ncase \"DIMM_UP\":\n    msg.payload = \"3,FF906F\";\nbreak;\n\ncase \"DIMM_DOWN\":\n    msg.payload = \"3,FF7A85\";\nbreak;\n\ncase \"MODE_UP\":\n    msg.payload = \"3,FFE01F\";\nbreak;\n\ncase \"MODE_DOWN\":\n    msg.payload = \"3,FF30CF\";\nbreak;\n\ncase \"TIMER\":\n    msg.payload = \"3,FFE21D\";\nbreak;\n    \n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 450,
        "y": 280,
        "wires": [
            [
                "bd62755a.e0d838",
                "d29d56a5.4ca1a8"
            ]
        ]
    },
    {
        "id": "bd62755a.e0d838",
        "type": "mqtt out",
        "z": "aeb6abf8.6695",
        "name": "",
        "topic": "iot/ircontroller/send",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 710,
        "y": 260,
        "wires": []
    },
    {
        "id": "d29d56a5.4ca1a8",
        "type": "debug",
        "z": "aeb6abf8.6695",
        "name": "ircontroller/send",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 700,
        "y": 300,
        "wires": []
    },
    {
        "id": "6965a533.19899c",
        "type": "inject",
        "z": "aeb6abf8.6695",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "OFF",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 270,
        "y": 360,
        "wires": [
            [
                "3d70fc5e.d818b4"
            ]
        ]
    },
    {
        "id": "ff6b4a09.14e278",
        "type": "mqtt in",
        "z": "aeb6abf8.6695",
        "name": "Xmas Lights commands",
        "topic": "iot/christmas_lights/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 230,
        "y": 420,
        "wires": [
            [
                "afb68f1a.0234a"
            ]
        ]
    },
    {
        "id": "afb68f1a.0234a",
        "type": "switch",
        "z": "aeb6abf8.6695",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "ON,OFF",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 430,
        "y": 420,
        "wires": [
            [
                "17411843.6d49b8"
            ]
        ]
    },
    {
        "id": "17411843.6d49b8",
        "type": "mqtt out",
        "z": "aeb6abf8.6695",
        "name": "",
        "topic": "iot/christmas_lights/status",
        "qos": "",
        "retain": "true",
        "broker": "b113ebbe.a57308",
        "x": 660,
        "y": 420,
        "wires": []
    },
    {
        "id": "e0914566.8f1938",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 340,
        "y": 1120,
        "wires": [
            [
                "2d2717b1.95bc1"
            ],
            [
                "2d2717b1.95bc1"
            ]
        ]
    },
    {
        "id": "58940f2e.643dc",
        "type": "mqtt out",
        "z": "3858decf.0fe052",
        "name": "",
        "topic": "iot/christmas_lights/set",
        "qos": "",
        "retain": "",
        "broker": "b113ebbe.a57308",
        "x": 710,
        "y": 1120,
        "wires": []
    },
    {
        "id": "2d2717b1.95bc1",
        "type": "change",
        "z": "3858decf.0fe052",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 1120,
        "wires": [
            [
                "58940f2e.643dc"
            ]
        ]
    },
    {
        "id": "304edb1c.03e764",
        "type": "switch",
        "z": "3858decf.0fe052",
        "name": "On or Off or Percent",
        "property": "command",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TurnOnRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "TurnOffRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IncrementPercentageRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "DecrementPercentageRequest",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "SetPercentageRequest",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 5,
        "x": 440,
        "y": 1500,
        "wires": [
            [
                "60647aea.91b324"
            ],
            [
                "969486ff.212e38"
            ],
            [
                "bedbb463.2c6978"
            ],
            [
                "bedbb463.2c6978"
            ],
            [
                "8a44132c.c390a"
            ]
        ]
    },
    {
        "id": "d06bcbdf.4671f8",
        "type": "inject",
        "z": "c85a3990.712ae8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Hey sexy",
        "payloadType": "str",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "ab59d80b.9380d8"
            ]
        ]
    },
    {
        "id": "279ebed2.470b82",
        "type": "debug",
        "z": "c85a3990.712ae8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 610,
        "y": 280,
        "wires": []
    },
    {
        "id": "1fbed3bd.7b70cc",
        "type": "http in",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "url": "/motion/:camera",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 100,
        "wires": [
            [
                "a664b660.2d2bf8",
                "b4aa42b.5bc89c",
                "7759022d.50d5cc"
            ]
        ]
    },
    {
        "id": "4716851c.a9e98c",
        "type": "debug",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1070,
        "y": 80,
        "wires": []
    },
    {
        "id": "a664b660.2d2bf8",
        "type": "template",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "plain",
        "template": "success",
        "output": "str",
        "x": 120,
        "y": 180,
        "wires": [
            [
                "7de24c09.1fd3a4"
            ]
        ]
    },
    {
        "id": "7de24c09.1fd3a4",
        "type": "http response",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 130,
        "y": 260,
        "wires": []
    },
    {
        "id": "b4aa42b.5bc89c",
        "type": "switch",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "property": "req.params.camera",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "drive",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "porch",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "garden",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 290,
        "y": 300,
        "wires": [
            [
                "f28805bc.30b558"
            ],
            [
                "a96a1d2c.69243"
            ],
            [
                "5084e16f.db16e"
            ]
        ]
    },
    {
        "id": "7759022d.50d5cc",
        "type": "template",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{req.params.camera}} Motion triggered",
        "output": "str",
        "x": 400,
        "y": 100,
        "wires": [
            [
                "4716851c.a9e98c"
            ]
        ]
    },
    {
        "id": "d948029.91679",
        "type": "template",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Drive Image Rec Service called",
        "output": "str",
        "x": 860,
        "y": 160,
        "wires": [
            [
                "4716851c.a9e98c"
            ]
        ]
    },
    {
        "id": "b9831ece.90c48",
        "type": "template",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Porch Image Rec Service called",
        "output": "str",
        "x": 900,
        "y": 240,
        "wires": [
            [
                "4716851c.a9e98c"
            ]
        ]
    },
    {
        "id": "d4b818e7.7b7bc8",
        "type": "template",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Garden Image Rec Service called",
        "output": "str",
        "x": 860,
        "y": 380,
        "wires": [
            [
                "4716851c.a9e98c"
            ]
        ]
    },
    {
        "id": "f28805bc.30b558",
        "type": "delay",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 440,
        "y": 220,
        "wires": [
            [
                "81623fd2.2424a"
            ]
        ]
    },
    {
        "id": "a96a1d2c.69243",
        "type": "delay",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 480,
        "y": 300,
        "wires": [
            [
                "51a3c365.6d229c"
            ]
        ]
    },
    {
        "id": "5084e16f.db16e",
        "type": "delay",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 440,
        "y": 380,
        "wires": [
            [
                "644a7fd7.9b1fc"
            ]
        ]
    },
    {
        "id": "f68318e1.de3008",
        "type": "http request",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": false,
        "url": "https://192.168.1.70:5001/webapi/entry.cgi?api=SYNO.SurveillanceStation.Webhook&method=\"Incoming\"&version=1&token=tLjKntCm7i7IXjtMGtRe7PIZBvSDqrJZeQWzpL6IIokWNKw2O0MYUUv8OEJXHlXJ",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 230,
        "y": 540,
        "wires": [
            [
                "70ef1509.bbb61c"
            ]
        ]
    },
    {
        "id": "ba22d270.bac0c",
        "type": "inject",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 420,
        "wires": [
            [
                "45303790.267528"
            ]
        ]
    },
    {
        "id": "70ef1509.bbb61c",
        "type": "debug",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 380,
        "y": 600,
        "wires": []
    },
    {
        "id": "45303790.267528",
        "type": "function",
        "z": "7d5e0229.53f9e4",
        "name": "Enable Unauth",
        "func": "msg.rejectUnauthorized = false;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 200,
        "y": 500,
        "wires": [
            [
                "f68318e1.de3008"
            ]
        ]
    },
    {
        "id": "4511da92.bf6f24",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "24907",
        "acknoledge": true,
        "name": "TV",
        "topic": "",
        "x": 110,
        "y": 200,
        "wires": [
            [
                "785e316c.93a59"
            ]
        ]
    },
    {
        "id": "f543e24b.8d07f",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "24906",
        "acknoledge": true,
        "name": "SONOS",
        "topic": "",
        "x": 110,
        "y": 340,
        "wires": [
            [
                "c1b6f38f.d1369"
            ]
        ]
    },
    {
        "id": "2b1217fe.99d1b8",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "d": true,
        "conf": "76993064.c8927",
        "device": "24908",
        "acknoledge": true,
        "name": "Vinyl",
        "topic": "",
        "x": 110,
        "y": 460,
        "wires": [
            [
                "ea66abf6.868228"
            ]
        ]
    },
    {
        "id": "d5f3f442.78cc88",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "25406",
        "acknoledge": true,
        "name": "Netflix",
        "topic": "",
        "x": 130,
        "y": 960,
        "wires": [
            [
                "93fa26c3.f7ce78"
            ]
        ]
    },
    {
        "id": "819ba367.bba7d",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "25681",
        "acknoledge": true,
        "name": "TV sound",
        "topic": "",
        "x": 120,
        "y": 680,
        "wires": [
            [
                "47acc084.8aa54"
            ]
        ]
    },
    {
        "id": "a3dfb3e2.f5191",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "25682",
        "acknoledge": true,
        "name": "Amp sound",
        "topic": "",
        "x": 110,
        "y": 820,
        "wires": [
            [
                "2a14b390.b30b8c"
            ]
        ]
    },
    {
        "id": "672c108c.97384",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "83965",
        "acknoledge": true,
        "name": "Christmas Lights",
        "topic": "",
        "x": 155.79730224609375,
        "y": 1135.7193603515625,
        "wires": [
            [
                "e0914566.8f1938"
            ]
        ]
    },
    {
        "id": "1580d286.8aef3d",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98872",
        "acknoledge": true,
        "name": "Downstairs Bathroom Light",
        "topic": "light.shelly_shsw_1_ba680b",
        "x": 160,
        "y": 1220,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "9cec5859.dc5e28",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98874",
        "acknoledge": true,
        "name": "Back Bedroom Light",
        "topic": "light.shelly_shsw_1_b90033",
        "x": 130,
        "y": 1280,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "c5b2355e.d6aa38",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98868",
        "acknoledge": true,
        "name": "Garden Light",
        "topic": "light.shelly_shsw_1_c4ef56",
        "x": 110,
        "y": 1340,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "2d91689.280c598",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98880",
        "acknoledge": true,
        "name": "Bathroom Light",
        "topic": "light.shelly_shsw_1_ba6933",
        "x": 120,
        "y": 1400,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "5635677a.071458",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98867",
        "acknoledge": true,
        "name": "Day Room Light",
        "topic": "light.shelly_shdm_1_f3e936",
        "x": 120,
        "y": 1460,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "9f39fda9.87552",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98871",
        "acknoledge": true,
        "name": "Hall Light",
        "topic": "light.shelly_shsw_1_c487ec",
        "x": 100,
        "y": 1520,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "8c392880.e183b8",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98866",
        "acknoledge": true,
        "name": "Kitchen Light",
        "topic": "light.shelly_shdm_1_f3e93b",
        "x": 110,
        "y": 1580,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "39dc543c.42a0bc",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98873",
        "acknoledge": true,
        "name": "Landing Light",
        "topic": "light.shelly_shsw_1_c4e83e",
        "x": 110,
        "y": 1640,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "c62c99de.e0d4e8",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98870",
        "acknoledge": true,
        "name": "Library Light",
        "topic": "light.shelly_shdm_1_f3ebd2",
        "x": 110,
        "y": 1700,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "e5615e49.56476",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98869",
        "acknoledge": true,
        "name": "Living Room Light",
        "topic": "light.shelly_shdm_1_f3a24c",
        "x": 130,
        "y": 1760,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "75f575fc.1cdbec",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98876",
        "acknoledge": true,
        "name": "Master Bedroom Light",
        "topic": "light.shelly_shdm_1_db3e10",
        "x": 140,
        "y": 1820,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "4ef29b8b.53d574",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98877",
        "acknoledge": true,
        "name": "Porch Light",
        "topic": "light.shelly_shsw_1_c4f29c",
        "x": 110,
        "y": 1880,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "f017dbf.18fc628",
        "type": "alexa-home",
        "z": "3858decf.0fe052",
        "conf": "76993064.c8927",
        "device": "98877",
        "acknoledge": true,
        "name": "Porch Light",
        "topic": "light.shelly_shdm_1_f3a14a",
        "x": 110,
        "y": 1940,
        "wires": [
            [
                "304edb1c.03e764"
            ]
        ]
    },
    {
        "id": "4c20df67.3a45b",
        "type": "alexa-remote-routine",
        "z": "c85a3990.712ae8",
        "name": "",
        "account": "1d68d899.7ab677",
        "routineNode": {
            "type": "speak",
            "payload": {
                "type": "announcement",
                "text": {
                    "type": "str",
                    "value": "You left the light on eey jit"
                },
                "devices": [
                    "G090LF10726427RS"
                ]
            }
        },
        "x": 420,
        "y": 280,
        "wires": [
            [
                "279ebed2.470b82"
            ]
        ]
    },
    {
        "id": "b3d772c9.93237",
        "type": "ha-fire-event",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "event": "",
        "data": "",
        "x": 250,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "4db268df.d06618",
        "type": "api-call-service",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "switch",
        "service": "toggle",
        "data": "{\"entity_id\":\"switch.living_room_ceiling\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 440,
        "y": 1660,
        "wires": [
            []
        ]
    },
    {
        "id": "7db69bd9.b08624",
        "type": "api-call-service",
        "z": "91083d3a.54dc1",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "homeassistant",
        "service": "update_entity",
        "data": "{\"entity_id\":\"sensor.next_train_to_wat\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 700,
        "y": 100,
        "wires": [
            [
                "6d6729a5.7ebe38"
            ]
        ]
    },
    {
        "id": "f220107.74405f",
        "type": "api-call-service",
        "z": "91083d3a.54dc1",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "input_boolean",
        "service": "toggle",
        "data": "{\"entity_id\":\"input_boolean.toggle_transport_api\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 170,
        "y": 160,
        "wires": [
            [
                "5f06c0f5.0bf84"
            ]
        ]
    },
    {
        "id": "a929f9ff.f2ff8",
        "type": "api-call-service",
        "z": "3ab1b3d8.bd433c",
        "name": "Notification to Mark's Phone",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "notify",
        "service": "ios_marks_iphone",
        "data": "{\"message\":\"{{payload}}\",\"title\":\"Sonoff RF Hub disconnected\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1640,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "bf61d608.6abff",
        "type": "api-call-service",
        "z": "3ab1b3d8.bd433c",
        "name": "Notification to HASS App",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{\"message\":\"{{payload}}\",\"title\":\"Sonoff RF Hub disconnected\",\"notification_id\":\"sonoffRFalert\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1630,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "55a0f17f.6e6258",
        "type": "api-call-service",
        "z": "7c38d180.0695d",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "homeassistant",
        "service": "restart",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 220,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "af62efff.b620d",
        "type": "api-call-service",
        "z": "3ab1b3d8.bd433c",
        "name": "Notification to HASS App",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{\"message\":\"{{payload}}\",\"title\":\"BLE Hub disconnected\",\"notification_id\":\"BLEalert\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1610,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "ab472dd0.cfb83",
        "type": "api-call-service",
        "z": "3ab1b3d8.bd433c",
        "name": "Notification to Mark's Phone",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "notify",
        "service": "ios_marks_iphone",
        "data": "{\"message\":\"{{payload}}\",\"title\":\"BLE Hub disconnected\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1620,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "6b7f84ca.ab29bc",
        "type": "api-call-service",
        "z": "91083d3a.54dc1",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "switch",
        "service": "turn_on",
        "data": "{\"entity_id\":\"switch.test_temperature_restart\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 170,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "60647aea.91b324",
        "type": "api-call-service",
        "z": "3858decf.0fe052",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"{{topic}}\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 690,
        "y": 1400,
        "wires": [
            []
        ]
    },
    {
        "id": "969486ff.212e38",
        "type": "api-call-service",
        "z": "3858decf.0fe052",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"{{topic}}\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 690,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "bedbb463.2c6978",
        "type": "api-call-service",
        "z": "3858decf.0fe052",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"{{topic}}\",\"brightness_step_pct\":\"{{payload}}\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 690,
        "y": 1520,
        "wires": [
            []
        ]
    },
    {
        "id": "8a44132c.c390a",
        "type": "api-call-service",
        "z": "3858decf.0fe052",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"{{topic}}\",\"brightness_pct\":\"{{payload}}\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 690,
        "y": 1560,
        "wires": [
            []
        ]
    },
    {
        "id": "ab59d80b.9380d8",
        "type": "api-call-service",
        "z": "c85a3990.712ae8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "notify",
        "service": "alexa_media_mark_s_echo_dot",
        "data": "{\"message\":\"{{payload}}\",\"data\":{\"type\":\"announce\"},\"target\":\"{{service}}\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 540,
        "y": 360,
        "wires": [
            [
                "279ebed2.470b82"
            ]
        ]
    },
    {
        "id": "81623fd2.2424a",
        "type": "api-call-service",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "image_processing",
        "service": "scan",
        "data": "{\"entity_id\":\"image_processing.drive_image_recogntion\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 680,
        "y": 200,
        "wires": [
            [
                "d948029.91679"
            ]
        ]
    },
    {
        "id": "51a3c365.6d229c",
        "type": "api-call-service",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": "1",
        "debugenabled": false,
        "service_domain": "image_processing",
        "service": "scan",
        "entityId": "image_processing.porch_image_recognition",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 740,
        "y": 300,
        "wires": [
            [
                "b9831ece.90c48"
            ]
        ]
    },
    {
        "id": "644a7fd7.9b1fc",
        "type": "api-call-service",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "service_domain": "image_processing",
        "service": "scan",
        "data": "{\"entity_id\":\"image_processing.garden_image_recognition\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 680,
        "y": 440,
        "wires": [
            [
                "d4b818e7.7b7bc8"
            ]
        ]
    },
    {
        "id": "fae61a59.c6dd28",
        "type": "server-state-changed",
        "z": "ecafbd20.fc3e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "switch.living_room_ceiling",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 280,
        "y": 1520,
        "wires": [
            [
                "2505a2a2.cb1a3e"
            ]
        ]
    },
    {
        "id": "40462cac.581a74",
        "type": "server-state-changed",
        "z": "53b9a091.ecbea",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "sensor.day_room_temperature",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 170,
        "y": 660,
        "wires": [
            [
                "46b694de.9e0cfc"
            ]
        ]
    },
    {
        "id": "4baee336.f2ec0c",
        "type": "server-state-changed",
        "z": "91083d3a.54dc1",
        "name": "Transport API Toggle",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "input_boolean.toggle_transport_api",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "habool",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 80,
        "y": 80,
        "wires": [
            [
                "5f06c0f5.0bf84"
            ]
        ]
    },
    {
        "id": "5248fbc2.ea6d94",
        "type": "server-state-changed",
        "z": "3ab1b3d8.bd433c",
        "name": "BLE Hub Disconnect",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "binary_sensor.ble_sensor_hub",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "x": 610,
        "y": 520,
        "wires": [
            [
                "2a8dfd7b.70bed2"
            ],
            [
                "bcc89a41.7295a8"
            ]
        ]
    },
    {
        "id": "c67cb14f.ea276",
        "type": "server-state-changed",
        "z": "3ab1b3d8.bd433c",
        "name": "Sonoff Hub Disconnect",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "binary_sensor.sonoff_rf_bridge",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "off, unavailable",
        "halt_if_type": "str",
        "halt_if_compare": "includes",
        "outputs": 2,
        "output_only_on_state_change": true,
        "x": 580,
        "y": 240,
        "wires": [
            [
                "42f710ea.d84cc"
            ],
            []
        ]
    },
    {
        "id": "3c6d7399.451e7c",
        "type": "server-state-changed",
        "z": "53b9a091.ecbea",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "sensor.day_room_temperature",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "num",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 190,
        "y": 1200,
        "wires": [
            [
                "f38fa315.6cee68",
                "39dc68c5.ebc968"
            ]
        ]
    },
    {
        "id": "7dd71952.6b50d",
        "type": "server-state-changed",
        "z": "53b9a091.ecbea",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "entityidfilter": "sensor.kitchen_temperature",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "num",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 190,
        "y": 1300,
        "wires": [
            [
                "5667dbab.ac3724"
            ]
        ]
    },
    {
        "id": "24f84f0e.b20eb",
        "type": "api-current-state",
        "z": "91083d3a.54dc1",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "input_boolean.toggle_transport_api",
        "state_type": "habool",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": true,
        "x": 590,
        "y": 40,
        "wires": [
            [
                "7db69bd9.b08624"
            ],
            [
                "6d6729a5.7ebe38"
            ]
        ]
    },
    {
        "id": "41627a10.e348f4",
        "type": "api-current-state",
        "z": "3ab1b3d8.bd433c",
        "name": "BLE Hub Connection Check",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "binary_sensor.ble_sensor_hub",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 900,
        "y": 680,
        "wires": [
            [
                "1d381e33.1e8422"
            ],
            [
                "bcc89a41.7295a8"
            ]
        ]
    },
    {
        "id": "ebc5f23d.2a8c58",
        "type": "api-current-state",
        "z": "3ab1b3d8.bd433c",
        "name": "Sonoff RF Hub Connection Check",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "navailable",
        "halt_if_type": "str",
        "halt_if_compare": "includes",
        "override_topic": false,
        "entity_id": "binary_sensor.sonoff_rf_bridge",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 1000,
        "y": 340,
        "wires": [
            [
                "8b60a3d5.c0d7"
            ],
            [
                "f4e49553.2e7fd8"
            ]
        ]
    },
    {
        "id": "cb735de4.912538",
        "type": "api-current-state",
        "z": "3ab1b3d8.bd433c",
        "name": "BLE Hub Connection Check",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "binary_sensor.ble_sensor_hub",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 580,
        "y": 680,
        "wires": [
            [
                "2a8dfd7b.70bed2"
            ],
            []
        ]
    },
    {
        "id": "4ab1ad9c.461fb4",
        "type": "interval-length",
        "z": "7c38d180.0695d",
        "format": "mills",
        "bytopic": false,
        "minimum": "",
        "maximum": "",
        "window": "",
        "timeout": false,
        "msgTimeout": "6",
        "minimumunit": "msecs",
        "maximumunit": "mins",
        "windowunit": "msecs",
        "msgTimeoutUnit": "mins",
        "reset": false,
        "startup": false,
        "msgField": "payload",
        "timestampField": "timestamp",
        "repeatTimeout": true,
        "name": "",
        "x": 360,
        "y": 180,
        "wires": [
            [
                "b0c0d5af.f51a88"
            ],
            [
                "2ec7267f.beac4a",
                "b0c0d5af.f51a88",
                "faf0aa48.e91bc8"
            ]
        ]
    },
    {
        "id": "18fd2258.a9270e",
        "type": "ramp-thermostat",
        "z": "53b9a091.ecbea",
        "name": "",
        "profile": "a6a7a981.db5148",
        "hysteresisplus": "1",
        "hysteresisminus": "1",
        "x": 410,
        "y": 120,
        "wires": [
            [
                "41c5a9e.c6d7958",
                "ac0d91df.07286"
            ],
            [
                "41c5a9e.c6d7958"
            ],
            [
                "41c5a9e.c6d7958"
            ]
        ]
    },
    {
        "id": "8abeb326.25832",
        "type": "ramp-thermostat",
        "z": "53b9a091.ecbea",
        "name": "UFH Schedule",
        "profile": "662613ce.27d1dc",
        "hysteresisplus": "0.2",
        "hysteresisminus": "0.2",
        "x": 320,
        "y": 774,
        "wires": [
            [
                "fba630c7.40439"
            ],
            [],
            []
        ]
    },
    {
        "id": "45f80775.8a3b78",
        "type": "ramp-thermostat",
        "z": "53b9a091.ecbea",
        "name": "Central Heating Schedule",
        "profile": "662613ce.27d1dc",
        "hysteresisplus": "0",
        "hysteresisminus": "0",
        "x": 370,
        "y": 1000,
        "wires": [
            [
                "a3b341c.2ab80c",
                "9fcbb93a.60f3e8",
                "563459e7.d0342"
            ],
            [],
            []
        ]
    },
    {
        "id": "9bb23574.a14a88",
        "type": "inject",
        "z": "7d5e0229.53f9e4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 410,
        "y": 180,
        "wires": [
            [
                "81623fd2.2424a",
                "51a3c365.6d229c",
                "644a7fd7.9b1fc"
            ]
        ]
    },
    {
        "id": "ab8748ef.a31458",
        "type": "inject",
        "z": "5365d4a0.afc36c",
        "name": "start Running",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 260,
        "wires": [
            [
                "26e036ef.e5905a"
            ]
        ]
    },
    {
        "id": "33d49fdc.7d2d",
        "type": "function",
        "z": "5012390b.b0f3b",
        "name": "",
        "func": "//START TIME\nvar d = new Date();\nvar startTime = d.toISOString();\n\nflow.set('startTime',startTime);\n\nmsg.startTime = startTime;\n\n//PREV VARIABLES\nvar haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar prevKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\nvar prevCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nflow.set(\"prevKwh\",prevKwh);\nflow.set(\"prevCost\",prevCost);\n\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 260,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "a5503421.3bd548",
        "type": "ha-wait-until",
        "z": "5365d4a0.afc36c",
        "name": "Wait price change",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is_not",
        "value": "prevCost",
        "valueType": "flow",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 730,
        "y": 460,
        "wires": [
            [
                "2ed8f4c2.86503c"
            ]
        ]
    },
    {
        "id": "6b17ee64.3c1fb8",
        "type": "ha-wait-until",
        "z": "5365d4a0.afc36c",
        "name": "Wait machine end",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "input_select.washing_status",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is",
        "value": "Complete",
        "valueType": "str",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 210,
        "y": 460,
        "wires": [
            [
                "a85e13e0.e02be"
            ]
        ]
    },
    {
        "id": "a607a34e.6d45c",
        "type": "server-state-changed",
        "z": "5365d4a0.afc36c",
        "name": "Running",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "input_select.washing_status",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "Running",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "x": 140,
        "y": 320,
        "wires": [
            [
                "26e036ef.e5905a"
            ],
            []
        ]
    },
    {
        "id": "faeedca.6c3622",
        "type": "change",
        "z": "5365d4a0.afc36c",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 400,
        "wires": [
            [
                "a5503421.3bd548"
            ]
        ]
    },
    {
        "id": "a85e13e0.e02be",
        "type": "change",
        "z": "5365d4a0.afc36c",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"input_boolean.washing_status\"}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 460,
        "wires": [
            [
                "a5503421.3bd548",
                "2ed8f4c2.86503c",
                "6b17ee64.3c1fb8"
            ]
        ]
    },
    {
        "id": "2ed8f4c2.86503c",
        "type": "function",
        "z": "5365d4a0.afc36c",
        "name": "calcUsagenCost",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\nvar newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\n\nvar totalKwh = flow.get('totalKwh')||0.00;\nvar totalCost = flow.get('totalCost')||0.00;\n\nvar addKwh = parseFloat(newKwh) - parseFloat(prevKwh);\ntotalKwh = parseFloat(totalKwh) + addKwh;\n//totalKwh = Number(totalKwh).toFixed(2);\n\nvar addCost = parseFloat(newCost) * parseFloat(addKwh);\ntotalCost = parseFloat(totalCost) + addCost;\n//totalCost = Number(totalCost).toFixed(2);\n\nflow.set(\"prevKwh\",newKwh);\nflow.set(\"prevCost\",newCost);\nflow.set(\"totalKwh\",totalKwh);\nflow.set(\"totalCost\", totalCost)\n\nmsg.payload = \"Used so far \" + totalKwh + \"kWh\\nCost so far \" + totalCost + \"p\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.addKwh = addKwh;\nmsg.addCost = addCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 660,
        "y": 540,
        "wires": [
            [
                "7520f532.98963c"
            ]
        ]
    },
    {
        "id": "77f45a2e.986c54",
        "type": "inject",
        "z": "5365d4a0.afc36c",
        "name": "End",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 540,
        "wires": [
            [
                "a85e13e0.e02be"
            ]
        ]
    },
    {
        "id": "7520f532.98963c",
        "type": "switch",
        "z": "5365d4a0.afc36c",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 830,
        "y": 540,
        "wires": [
            [
                "6da6b878.453708"
            ],
            [
                "819108e9.ec81d8"
            ]
        ]
    },
    {
        "id": "6da6b878.453708",
        "type": "change",
        "z": "5365d4a0.afc36c",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 520,
        "wires": [
            [
                "a5503421.3bd548"
            ]
        ]
    },
    {
        "id": "2d01282.7712dd8",
        "type": "inject",
        "z": "5365d4a0.afc36c",
        "name": "Price Change",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 450,
        "y": 620,
        "wires": [
            [
                "2ed8f4c2.86503c"
            ]
        ]
    },
    {
        "id": "13a75407.19886c",
        "type": "file",
        "z": "5365d4a0.afc36c",
        "name": "",
        "filename": "/data/washingDB.csv",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1260,
        "y": 680,
        "wires": [
            [
                "49990ca2.b64bd4"
            ]
        ]
    },
    {
        "id": "8eb4e554.271558",
        "type": "inject",
        "z": "fd719e13.69936",
        "name": "start Running",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 100,
        "wires": [
            [
                "b2466eb2.d6e39"
            ]
        ]
    },
    {
        "id": "65b66b7b.a8ec54",
        "type": "function",
        "z": "fd719e13.69936",
        "name": "set Prev variables",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar prevKwh = configCtx.states[\"sensor.shelly_shsw_pm_f2febe_total_consumption\"].state;\nvar prevCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nflow.set(\"prevKwh\", parseFloat(prevKwh));\nflow.set(\"prevCost\",prevCost);\n\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 180,
        "wires": [
            [
                "b840dcb4.8e46a",
                "97b90f05.c563",
                "40979b6e.49bc04"
            ]
        ]
    },
    {
        "id": "b2466eb2.d6e39",
        "type": "function",
        "z": "fd719e13.69936",
        "name": "set Start Time",
        "func": "// var startTime=flow.get('startTime');\nvar startTime = new Date();\n\nflow.set('startTime',startTime);\n\nmsg.startTime = startTime;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 140,
        "wires": [
            [
                "65b66b7b.a8ec54"
            ]
        ]
    },
    {
        "id": "b2e76b4e.f0f868",
        "type": "ha-wait-until",
        "z": "fd719e13.69936",
        "name": "Wait price change",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is_not",
        "value": "prevCost",
        "valueType": "flow",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 810,
        "y": 280,
        "wires": [
            [
                "2c90a002.f4adf"
            ]
        ]
    },
    {
        "id": "97b90f05.c563",
        "type": "ha-wait-until",
        "z": "fd719e13.69936",
        "name": "Wait machine end",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "input_select.tumble_dryer_status",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is",
        "value": "Complete",
        "valueType": "str",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 290,
        "y": 300,
        "wires": [
            [
                "95c0f51f.52e2b8"
            ]
        ]
    },
    {
        "id": "61ebc68a.0974c8",
        "type": "server-state-changed",
        "z": "fd719e13.69936",
        "name": "Running",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "input_select.tumble_dryer_status",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "Running",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "x": 200,
        "y": 160,
        "wires": [
            [
                "b2466eb2.d6e39"
            ],
            []
        ]
    },
    {
        "id": "40979b6e.49bc04",
        "type": "debug",
        "z": "fd719e13.69936",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 160,
        "wires": []
    },
    {
        "id": "b840dcb4.8e46a",
        "type": "change",
        "z": "fd719e13.69936",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 240,
        "wires": [
            [
                "b2e76b4e.f0f868"
            ]
        ]
    },
    {
        "id": "95c0f51f.52e2b8",
        "type": "change",
        "z": "fd719e13.69936",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"input_boolean.washing_status\"}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 300,
        "wires": [
            [
                "b2e76b4e.f0f868",
                "2c90a002.f4adf",
                "97b90f05.c563"
            ]
        ]
    },
    {
        "id": "2c90a002.f4adf",
        "type": "function",
        "z": "fd719e13.69936",
        "name": "calcUsagenCost",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f2febe_total_consumption\"].state;\nvar newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\n\nvar totalKwh = flow.get('totalKwh')||0.00;\nvar totalCost = flow.get('totalCost')||0.00;\n\nvar addKwh = parseFloat(newKwh) - parseFloat(prevKwh);\ntotalKwh = parseFloat(totalKwh) + addKwh;\n//totalKwh = Number(totalKwh).toFixed(2);\n\nvar addCost = parseFloat(newCost) * parseFloat(addKwh);\ntotalCost = parseFloat(totalCost) + addCost;\n//totalCost = Number(totalCost).toFixed(2);\n\nflow.set(\"prevKwh\",newKwh);\nflow.set(\"prevCost\",newCost);\nflow.set(\"totalKwh\",totalKwh);\nflow.set(\"totalCost\", totalCost)\n\nmsg.payload = \"Used so far \" + totalKwh + \"kWh\\nCost so far \" + totalCost + \"p\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.addKwh = addKwh;\nmsg.addCost = addCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 700,
        "y": 380,
        "wires": [
            [
                "bd132080.8f72d"
            ]
        ]
    },
    {
        "id": "d1a5bcd2.19c51",
        "type": "inject",
        "z": "fd719e13.69936",
        "name": "End",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 310,
        "y": 380,
        "wires": [
            [
                "95c0f51f.52e2b8"
            ]
        ]
    },
    {
        "id": "bd132080.8f72d",
        "type": "switch",
        "z": "fd719e13.69936",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 890,
        "y": 380,
        "wires": [
            [
                "901b0cc.65341f"
            ],
            [
                "131f8936.d70597"
            ]
        ]
    },
    {
        "id": "901b0cc.65341f",
        "type": "change",
        "z": "fd719e13.69936",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1040,
        "y": 360,
        "wires": [
            [
                "b2e76b4e.f0f868"
            ]
        ]
    },
    {
        "id": "12082540.3e5a4b",
        "type": "inject",
        "z": "fd719e13.69936",
        "name": "Price Change",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 510,
        "y": 460,
        "wires": [
            [
                "2c90a002.f4adf"
            ]
        ]
    },
    {
        "id": "64ee1175.12d16",
        "type": "file",
        "z": "fd719e13.69936",
        "name": "",
        "filename": "/data/tumbleDB.csv",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1340,
        "y": 520,
        "wires": [
            [
                "2fe8caf8.564a56"
            ]
        ]
    },
    {
        "id": "8a8b61db.3c793",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "start Running",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 100,
        "wires": [
            [
                "952bdaa8.7297b8"
            ]
        ]
    },
    {
        "id": "4ba33a39.4a1894",
        "type": "function",
        "z": "d4f39d50.9849d",
        "name": "set Prev variables",
        "func": "var haCtx = global.get(\"homeassistant\");\n\nnode.warn(haCtx);\n\nvar configCtx = haCtx.homeAssistantProd;\n\nvar prevKwh = configCtx.states[\"sensor.shelly_shsw_pm_84cca8ab1c05_total_consumption\"].state;\nvar prevCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nflow.set(\"prevKwh\", parseFloat(prevKwh));\nflow.set(\"prevCost\",prevCost);\n\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 180,
        "wires": [
            [
                "6832132e.57e55c",
                "3c69b284.2e696e",
                "26674d47.13ab12"
            ]
        ]
    },
    {
        "id": "952bdaa8.7297b8",
        "type": "function",
        "z": "d4f39d50.9849d",
        "name": "set Start Time",
        "func": "// var startTime=flow.get('startTime');\nvar startTime = new Date();\n\nflow.set('startTime',startTime);\n\nmsg.startTime = startTime;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 140,
        "wires": [
            [
                "4ba33a39.4a1894"
            ]
        ]
    },
    {
        "id": "ac4374e5.ebb2a8",
        "type": "function",
        "z": "d4f39d50.9849d",
        "name": "addtodb",
        "func": "// var haCtx = global.get(\"homeassistant\");\n// var configCtx = haCtx.homeAssistantProd;\n\n// var newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\n// var newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\nvar totalKwh = flow.get('totalKwh');\ntotalKwh = totalKwh.toFixed(2);\nvar totalCost = flow.get('totalCost')\ntotalCost = totalCost.toFixed(2);\nvar startTime = flow.get('startTime');\n\nvar d = new Date();\nvar totalTime = d.getTime() - startTime.getTime();\nvar totalTimeMins = totalTime / 60000;\ntotalTimeMins = totalTimeMins.toFixed(0);\nflow.set(\"totalTimeMins\",totalTimeMins);\n\n\nmsg.payload = \"Dishwasher Complete:\\nUsed \" + totalKwh + \"kWh\\nCost \" + totalCost + \"p\\nTook \" + totalTimeMins + \"mins\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\nmsg.startTime = startTime.getTime();\nmsg.endTime = d.getTime();\nmsg.totalTimeMins = totalTimeMins;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1020,
        "y": 440,
        "wires": [
            [
                "d27f11d6.eea6c",
                "ca58546f.5c0a68",
                "cdb2b04b.b49f6"
            ]
        ]
    },
    {
        "id": "29397221.7a486e",
        "type": "ha-wait-until",
        "z": "d4f39d50.9849d",
        "name": "Wait price change",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is_not",
        "value": "prevCost",
        "valueType": "flow",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 750,
        "y": 300,
        "wires": [
            [
                "9cbdeeae.dba3"
            ]
        ]
    },
    {
        "id": "26674d47.13ab12",
        "type": "ha-wait-until",
        "z": "d4f39d50.9849d",
        "name": "Wait machine end",
        "server": "a4a1abdf.7ba5b8",
        "outputs": 1,
        "entityId": "input_select.dishwasher_status",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is",
        "value": "Complete",
        "valueType": "str",
        "timeout": 0,
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": false,
        "x": 250,
        "y": 300,
        "wires": [
            [
                "a3b3a812.d0c2a8"
            ]
        ]
    },
    {
        "id": "5bbba8aa.6f6528",
        "type": "server-state-changed",
        "z": "d4f39d50.9849d",
        "name": "Running",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "input_select.dishwasher_status",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "Running",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "x": 160,
        "y": 160,
        "wires": [
            [
                "952bdaa8.7297b8"
            ],
            []
        ]
    },
    {
        "id": "3c69b284.2e696e",
        "type": "debug",
        "z": "d4f39d50.9849d",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 160,
        "wires": []
    },
    {
        "id": "6832132e.57e55c",
        "type": "change",
        "z": "d4f39d50.9849d",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 240,
        "wires": [
            [
                "29397221.7a486e"
            ]
        ]
    },
    {
        "id": "a3b3a812.d0c2a8",
        "type": "change",
        "z": "d4f39d50.9849d",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"input_boolean.washing_status\"}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 300,
        "wires": [
            [
                "29397221.7a486e",
                "9cbdeeae.dba3",
                "26674d47.13ab12"
            ]
        ]
    },
    {
        "id": "9cbdeeae.dba3",
        "type": "function",
        "z": "d4f39d50.9849d",
        "name": "calcUsagenCost",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar newKwh = configCtx.states[\"sensor.shelly_shsw_pm_84cca8ab1c05_total_consumption\"].state;\nvar newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\n\nvar totalKwh = flow.get('totalKwh')||0.00;\nvar totalCost = flow.get('totalCost')||0.00;\n\nvar addKwh = parseFloat(newKwh) - parseFloat(prevKwh);\ntotalKwh = parseFloat(totalKwh) + addKwh;\n//totalKwh = Number(totalKwh).toFixed(2);\n\nvar addCost = parseFloat(newCost) * parseFloat(addKwh);\ntotalCost = parseFloat(totalCost) + addCost;\n//totalCost = Number(totalCost).toFixed(2);\n\nflow.set(\"prevKwh\",newKwh);\nflow.set(\"prevCost\",newCost);\nflow.set(\"totalKwh\",totalKwh);\nflow.set(\"totalCost\", totalCost)\n\nmsg.payload = \"Used so far \" + totalKwh + \"kWh\\nCost so far \" + totalCost + \"p\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.addKwh = addKwh;\nmsg.addCost = addCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 660,
        "y": 380,
        "wires": [
            [
                "a06194a0.516958",
                "3c69b284.2e696e"
            ]
        ]
    },
    {
        "id": "7324e898.e23e18",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "End",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 380,
        "wires": [
            [
                "a3b3a812.d0c2a8"
            ]
        ]
    },
    {
        "id": "a06194a0.516958",
        "type": "switch",
        "z": "d4f39d50.9849d",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 850,
        "y": 380,
        "wires": [
            [
                "841b90af.38eeb"
            ],
            [
                "ac4374e5.ebb2a8"
            ]
        ]
    },
    {
        "id": "841b90af.38eeb",
        "type": "change",
        "z": "d4f39d50.9849d",
        "name": "entity_id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"entity_id\":\"sensor.octopus_agile_current_rate\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1000,
        "y": 360,
        "wires": [
            [
                "29397221.7a486e"
            ]
        ]
    },
    {
        "id": "bd040f33.3f2e2",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "Price Change",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 470,
        "y": 460,
        "wires": [
            [
                "9cbdeeae.dba3"
            ]
        ]
    },
    {
        "id": "d27f11d6.eea6c",
        "type": "file",
        "z": "d4f39d50.9849d",
        "name": "",
        "filename": "/data/dishwasherDB.csv",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1330,
        "y": 500,
        "wires": [
            [
                "eba2e2a5.6f6ee"
            ]
        ]
    },
    {
        "id": "989e5bf0.3246a8",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 820,
        "y": 460,
        "wires": [
            [
                "ac4374e5.ebb2a8"
            ]
        ]
    },
    {
        "id": "8d63705f.7da0c",
        "type": "function",
        "z": "d033bdb8.8c963",
        "name": "",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\nvar newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\n\nvar totalKwh = flow.get('totalKwh')||0;\nvar totalCost = flow.get('totalCost')||0;\n\nvar addKwh = newKwh - prevKwh;\ntotalKwh += addKwh;\ntotalKwh = Number(totalKwh).toFixed(2);\n\nvar addCost = newCost * addKwh;\ntotalCost += addCost;\ntotalCost = Number(totalCost).toFixed(2);\n\nflow.set(\"prevKwh\",newKwh);\nflow.set(\"prevCost\",newCost);\nflow.set(\"totalKwh\",totalKwh);\nflow.set(\"totalCost\", totalCost)\n\nmsg.payload = newKwh;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 220,
        "y": 20,
        "wires": [
            []
        ]
    },
    {
        "id": "58569ed2.cc102",
        "type": "function",
        "z": "5365d4a0.afc36c",
        "name": "set Prev variables",
        "func": "var haCtx = global.get(\"homeassistant\");\nvar configCtx = haCtx.homeAssistantProd;\n\nvar prevKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\nvar prevCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nflow.set(\"prevKwh\", parseFloat(prevKwh));\nflow.set(\"prevCost\",prevCost);\n\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 320,
        "wires": [
            [
                "faeedca.6c3622",
                "6b17ee64.3c1fb8"
            ]
        ]
    },
    {
        "id": "26e036ef.e5905a",
        "type": "function",
        "z": "5365d4a0.afc36c",
        "name": "set Start Time",
        "func": "// var startTime=flow.get('startTime');\nvar startTime = new Date();\n\nflow.set('startTime',startTime);\n\nmsg.startTime = startTime;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 280,
        "wires": [
            [
                "58569ed2.cc102"
            ]
        ]
    },
    {
        "id": "eba2e2a5.6f6ee",
        "type": "change",
        "z": "d4f39d50.9849d",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "prevKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "prevCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "startTime",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "configCtx",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "haCtx",
                "pt": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 480,
        "wires": [
            [
                "a895a864.776588"
            ]
        ]
    },
    {
        "id": "df008d81.63b5b",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1510,
        "y": 400,
        "wires": [
            [
                "eba2e2a5.6f6ee"
            ]
        ]
    },
    {
        "id": "a895a864.776588",
        "type": "debug",
        "z": "d4f39d50.9849d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1870,
        "y": 480,
        "wires": []
    },
    {
        "id": "131f8936.d70597",
        "type": "function",
        "z": "fd719e13.69936",
        "name": "addtodb",
        "func": "// var haCtx = global.get(\"homeassistant\");\n// var configCtx = haCtx.homeAssistantProd;\n\n// var newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\n// var newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\nvar totalKwh = flow.get('totalKwh');\ntotalKwh = totalKwh.toFixed(2);\nvar totalCost = flow.get('totalCost')\ntotalCost = totalCost.toFixed(2);\nvar startTime = flow.get('startTime');\n\nvar d = new Date();\nvar totalTime = d.getTime() - startTime.getTime();\nvar totalTimeMins = totalTime / 60000;\ntotalTimeMins = totalTimeMins.toFixed(0);\nflow.set(\"totalTimeMins\",totalTimeMins);\n\nmsg.payload = \"Tumble Dryer Complete:\\nUsed \" + totalKwh + \"kWh\\nCost \" + totalCost + \"p\\nTook \" + totalTimeMins + \"mins\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\nmsg.startTime = startTime.getTime();\nmsg.endTime = d.getTime();\nmsg.totalTimeMins = totalTimeMins;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1060,
        "y": 440,
        "wires": [
            [
                "98fde8b2.057ec8",
                "64ee1175.12d16",
                "e741ef17.b37dd",
                "e7a98d0b.d1da5"
            ]
        ]
    },
    {
        "id": "c2f8366.c20fec8",
        "type": "inject",
        "z": "fd719e13.69936",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1550,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "2916cc19.e7da24",
        "type": "debug",
        "z": "fd719e13.69936",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 480,
        "wires": []
    },
    {
        "id": "98fde8b2.057ec8",
        "type": "debug",
        "z": "fd719e13.69936",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1230,
        "y": 380,
        "wires": []
    },
    {
        "id": "57741993.4a1fc8",
        "type": "inject",
        "z": "fd719e13.69936",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 860,
        "y": 460,
        "wires": [
            [
                "131f8936.d70597"
            ]
        ]
    },
    {
        "id": "819108e9.ec81d8",
        "type": "function",
        "z": "5365d4a0.afc36c",
        "name": "addtodb",
        "func": "// var haCtx = global.get(\"homeassistant\");\n// var configCtx = haCtx.homeAssistantProd;\n\n// var newKwh = configCtx.states[\"sensor.shelly_shsw_pm_f27e6f_total_consumption\"].state;\n// var newCost = configCtx.states[\"sensor.octopus_agile_current_rate\"].state;\n\nvar prevKwh = flow.get('prevKwh');\nvar prevCost = flow.get('prevCost');\nvar totalKwh = flow.get('totalKwh');\ntotalKwh = totalKwh.toFixed(2);\nvar totalCost = flow.get('totalCost')\ntotalCost = totalCost.toFixed(2);\nvar startTime = flow.get('startTime');\n\nvar d = new Date();\nvar totalTime = d.getTime() - startTime.getTime();\nvar totalTimeMins = totalTime / 60000;\ntotalTimeMins = totalTimeMins.toFixed(0);\nflow.set(\"totalTimeMins\",totalTimeMins);\n\n\nmsg.payload = \"Washing Machine Complete:\\nUsed \" + totalKwh + \"kWh\\nCost \" + totalCost + \"p\\nTook \" + totalTimeMins + \"mins\";\nmsg.prevKwh = prevKwh;\nmsg.prevCost = prevCost;\nmsg.totalKwh = totalKwh;\nmsg.totalCost = totalCost;\nmsg.startTime = startTime.getTime();\nmsg.endTime = d.getTime();\nmsg.totalTimeMins = totalTimeMins;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1000,
        "y": 600,
        "wires": [
            [
                "ed9e871c.338138",
                "13a75407.19886c",
                "eb7bbf75.dfb96",
                "3aba1fa4.4a161"
            ]
        ]
    },
    {
        "id": "c2507171.bfcb7",
        "type": "debug",
        "z": "5365d4a0.afc36c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1940,
        "y": 660,
        "wires": []
    },
    {
        "id": "ed9e871c.338138",
        "type": "debug",
        "z": "5365d4a0.afc36c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 540,
        "wires": []
    },
    {
        "id": "ba6a9f2b.8e929",
        "type": "inject",
        "z": "5365d4a0.afc36c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 800,
        "y": 620,
        "wires": [
            [
                "819108e9.ec81d8"
            ]
        ]
    },
    {
        "id": "2fe8caf8.564a56",
        "type": "change",
        "z": "fd719e13.69936",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "prevKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "prevCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "startTime",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "configCtx",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "haCtx",
                "pt": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1660,
        "y": 480,
        "wires": [
            [
                "2916cc19.e7da24"
            ]
        ]
    },
    {
        "id": "49990ca2.b64bd4",
        "type": "change",
        "z": "5365d4a0.afc36c",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "prevKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "prevCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalCost",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "totalKwh",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "startTime",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "configCtx",
                "pt": "flow"
            },
            {
                "t": "delete",
                "p": "haCtx",
                "pt": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 660,
        "wires": [
            [
                "c2507171.bfcb7"
            ]
        ]
    },
    {
        "id": "c5ab620d.089fd8",
        "type": "influxdb out",
        "z": "d4f39d50.9849d",
        "influxdb": "d4f057b1.bf3418",
        "name": "",
        "measurement": "appliance-use",
        "precision": "",
        "retentionPolicy": "",
        "database": "homeassistant",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "organisation",
        "bucket": "bucket",
        "x": 1510,
        "y": 340,
        "wires": []
    },
    {
        "id": "ca58546f.5c0a68",
        "type": "function",
        "z": "d4f39d50.9849d",
        "name": "",
        "func": "msg.payload = \n[{\n    totalKwh: flow.get('totalKwh'),\n    totalCost: flow.get('totalCost'),\n    totalTimeMins: flow.get('totalTimeMins'),\n    time: flow.get('startTime')\n},\n{\n    appliance: \"Dishwasher\"\n}];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1210,
        "y": 340,
        "wires": [
            [
                "c5ab620d.089fd8"
            ]
        ]
    },
    {
        "id": "e741ef17.b37dd",
        "type": "function",
        "z": "fd719e13.69936",
        "name": "",
        "func": "msg.payload = \n[{\n    totalKwh: flow.get('totalKwh'),\n    totalCost: flow.get('totalCost'),\n    totalTimeMins: flow.get('totalTimeMins'),\n    time: flow.get('startTime')\n},\n{\n    appliance: \"Tumble Dryer\"\n}];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1240,
        "y": 320,
        "wires": [
            [
                "34e1c91b.77fea6"
            ]
        ]
    },
    {
        "id": "34e1c91b.77fea6",
        "type": "influxdb out",
        "z": "fd719e13.69936",
        "influxdb": "d4f057b1.bf3418",
        "name": "",
        "measurement": "appliance-use",
        "precision": "",
        "retentionPolicy": "",
        "database": "homeassistant",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "organisation",
        "bucket": "bucket",
        "x": 1540,
        "y": 320,
        "wires": []
    },
    {
        "id": "eb7bbf75.dfb96",
        "type": "function",
        "z": "5365d4a0.afc36c",
        "name": "",
        "func": "msg.payload = \n[{\n    totalKwh: flow.get('totalKwh'),\n    totalCost: flow.get('totalCost'),\n    totalTimeMins: flow.get('totalTimeMins'),\n    time: flow.get('startTime')\n},\n{\n    appliance: \"Washing Machine\"\n}];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1180,
        "y": 480,
        "wires": [
            [
                "d35f5cad.13b84"
            ]
        ]
    },
    {
        "id": "d35f5cad.13b84",
        "type": "influxdb out",
        "z": "5365d4a0.afc36c",
        "influxdb": "d4f057b1.bf3418",
        "name": "",
        "measurement": "appliance-use",
        "precision": "",
        "retentionPolicy": "",
        "database": "homeassistant",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "organisation",
        "bucket": "bucket",
        "x": 1480,
        "y": 480,
        "wires": []
    },
    {
        "id": "80575bef.d68108",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "If plugged in and home - check battery",
        "info": "",
        "x": 730,
        "y": 40,
        "wires": []
    },
    {
        "id": "5d6cea5a.fd1474",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Check Battery",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 80,
        "wires": [
            [
                "8ea8b19d.0a795"
            ]
        ]
    },
    {
        "id": "9d9be451.9f60e8",
        "type": "switch",
        "z": "9d235989.43e7e8",
        "name": "switch",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 490,
        "y": 140,
        "wires": [
            [
                "5d6cea5a.fd1474"
            ],
            [
                "e4b688f3.89d268"
            ],
            [
                "b10c88d8.952708"
            ]
        ]
    },
    {
        "id": "e4b688f3.89d268",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Check Battery",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 160,
        "wires": [
            [
                "a3cd79e7.512af8"
            ]
        ]
    },
    {
        "id": "e1c09107.dff5d",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Check Home/Plugged In",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 80,
        "wires": [
            [
                "9d9be451.9f60e8"
            ]
        ]
    },
    {
        "id": "1639f28d.7fd79d",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "If not plugged in and home - check battery",
        "info": "",
        "x": 740,
        "y": 120,
        "wires": []
    },
    {
        "id": "65636973.9499a8",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "If not plugged in and not home - zero profile",
        "info": "",
        "x": 750,
        "y": 200,
        "wires": []
    },
    {
        "id": "a3cd79e7.512af8",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Check Target",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 950,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "8ea8b19d.0a795",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Check Target",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 950,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "d50bd4bc.b8ebe8",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "Calc Target",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 380,
        "wires": [
            [
                "19427381.656fcc",
                "f682f5be.63caf8"
            ]
        ]
    },
    {
        "id": "7a884e1a.3dd91",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Build Schedule Object",
        "info": "",
        "x": 150,
        "y": 340,
        "wires": []
    },
    {
        "id": "aaafa1.1919506",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Charging Profile Generator",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "b10c88d8.952708",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Zero Profile",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 750,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "9f050213.15b6c",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Charging Trigger",
        "info": "",
        "x": 120,
        "y": 620,
        "wires": []
    },
    {
        "id": "dcec1234.af68",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Update charge time",
        "info": "",
        "x": 130,
        "y": 940,
        "wires": []
    },
    {
        "id": "5ba1b519.41fbfc",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Profile Calc Trigger",
        "info": "If ",
        "x": 150,
        "y": 220,
        "wires": []
    },
    {
        "id": "50cb47f.a01aab8",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "Every half hour",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "1324bfbe.022e3",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "Teslamate Update/Home/Plugged In",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 140,
        "wires": [
            [
                "e1c09107.dff5d"
            ]
        ]
    },
    {
        "id": "89793ae4.5059c8",
        "type": "mqtt in",
        "z": "9d235989.43e7e8",
        "name": "",
        "topic": "teslamate/cars/1/geofence",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 1170,
        "y": 600,
        "wires": [
            [
                "6a393c56.3e3054"
            ]
        ]
    },
    {
        "id": "6a393c56.3e3054",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 600,
        "wires": []
    },
    {
        "id": "8838aa38.24c5c8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 680,
        "wires": []
    },
    {
        "id": "4e827fab.dfa05",
        "type": "mqtt in",
        "z": "9d235989.43e7e8",
        "name": "",
        "topic": "teslamate/#",
        "qos": "2",
        "datatype": "auto",
        "broker": "b113ebbe.a57308",
        "x": 1210,
        "y": 680,
        "wires": [
            [
                "8838aa38.24c5c8"
            ]
        ]
    },
    {
        "id": "19427381.656fcc",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "unknown",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "octopusagile.rates",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 380,
        "y": 380,
        "wires": [
            [
                "875d8e52.55207"
            ],
            [
                "ee259e2d.8e0a9"
            ]
        ]
    },
    {
        "id": "c8bc3fa0.f1668",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 360,
        "wires": []
    },
    {
        "id": "875d8e52.55207",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Digest rate data",
        "func": "var octopusagilerates = msg.data.attributes;\n\n//Iterate through Agile Rates Data and put into schedule object:\n\nvar i;\nvar rates = new Object();\n\nfor (i in octopusagilerates) {\n  var rate_obj = new Object();\n  rate_obj.rate = octopusagilerates[i];\n  rate_obj.charge = false;\n  rates[i] = rate_obj;\n}\n\nflow.set('schedule',rates);\nmsg.schedule = rates;\n\nflow.set('ratelist',octopusagilerates);\nmsg.ratelist = octopusagilerates;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is deployed.\n\nvar schedule = new Object()\nflow.set('schedule',schedule);\n\nvar ratelist = new Object()\nflow.set('rateList', ratelist);\n",
        "finalize": "",
        "x": 660,
        "y": 360,
        "wires": [
            [
                "ee259e2d.8e0a9"
            ]
        ]
    },
    {
        "id": "f7ccd97c.f43d68",
        "type": "file",
        "z": "9d235989.43e7e8",
        "name": "",
        "filename": "/data/evcharger/avg_schedule.json",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 940,
        "y": 1960,
        "wires": [
            []
        ]
    },
    {
        "id": "bb22b434.6d70a8",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Calc charge",
        "func": "var ratelist = flow.get('ratelist');\nvar target_time = flow.get('target_time');\nvar charge_reqd_sessions = flow.get('charge_reqd_sessions');\nvar schedule = flow.get('schedule');\nvar schedule_avg = flow.get('schedule_avg');\n//Iterate through rate list to remove times after target\n\nvar i;\nvar curr = new Date()\nvar ratelist_short = ratelist;\nvar d_max = new Date();\n\nfor (i in ratelist) {\n  var d = new Date(i);\n  if (d >= target_time) {\n    delete ratelist_short[i];\n  } else if (d < curr) {\n    delete ratelist_short[i];\n  } else if (d > d_max) {\n      d_max = d;\n  }\n}\n\nvar target_session_start = new Date(target_time.getTime() - (30*60*1000));\n\nwhile (target_session_start > d_max) {\n\n    var d_max_new = new Date(d_max.getTime() + (30*60*1000));\n    var dmax_hr = d_max_new.getHours();\n    if (dmax_hr <10) {\n        dmax_hr = \"0\" + dmax_hr;\n    }\n    \n    var dmax_min = d_max_new.getMinutes();\n    if (dmax_min <10) {\n        dmax_min = \"0\" + dmax_min;\n    } \n    \n    var dmax_rate = schedule_avg[dmax_hr + \":\" + dmax_min]\n    \n    var diff = d_max_new - curr;\n    \n    if (diff > (24*60*60*100)) {\n        dmax_rate *= 1.1;\n    } else if (diff > (2*24*60*60*100)) {\n        dmax_rate *= 1.3;\n    }\n\n      var rate_obj = new Object();\n      rate_obj.rate = dmax_rate.toFixed(2);\n      rate_obj.charge = false;\n      schedule[d_max_new.toISOString()] = rate_obj;    \n    \n    \n    d_max = d_max_new;\n    \n}\n\n//Sort ratelist into cheapest > most expensive\nfunction compare(a, b) {\n  return a[1] - b[1];\n}\n\nvar array = Object.entries(ratelist_short);\narray.sort(compare);\n\n//Find number of sessions\nvar array_top = array.slice(0,charge_reqd_sessions);\n\nmsg.array_top = array_top;\n\n//Mark charging sessions as true\nfor (i in array_top) {\n    var charge_date = array_top[i][0].toString();\n    schedule[charge_date][\"charge\"] = true;\n}\n  \nmsg.schedule = schedule;\n\nflow.set('schedule',schedule);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1090,
        "y": 440,
        "wires": [
            [
                "c8bc3fa0.f1668"
            ]
        ]
    },
    {
        "id": "f682f5be.63caf8",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "null",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "input_datetime.ev_charged_time",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 420,
        "y": 440,
        "wires": [
            [
                "afe4cef0.61ea1"
            ],
            []
        ]
    },
    {
        "id": "1a863aee.f0e2e5",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "null",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "input_number.ev_charge_target",
        "state_type": "str",
        "state_location": "target_charge",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 420,
        "y": 540,
        "wires": [
            [
                "70a91f93.6bc53"
            ],
            []
        ]
    },
    {
        "id": "afe4cef0.61ea1",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Capture target time",
        "func": "var target_time_timestamp = msg.data.attributes.timestamp*1000;\n/*var d = new Date();\nvar current_time_seconds = (d.getHours()*60*60) + (d.getMinutes()*60) + d.getSeconds();\n\nif (target_time_timestamp < current_time_seconds) {\n    target_time_timestamp += (24*60*60)\n}\n\nvar target_time_milliseconds = d.getTime() - current_time_seconds*1000 + target_time_timestamp*1000\n\nvar target_time = new Date(target_time_milliseconds);*/\n\nvar target_time = new Date(target_time_timestamp);\n\nflow.set('target_time',target_time);\nmsg.target_time = target_time;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is deployed.\n\nvar target_time = new Date()\nflow.set('target_time',target_time);\n",
        "finalize": "",
        "x": 750,
        "y": 460,
        "wires": [
            [
                "ee259e2d.8e0a9",
                "6fd7469a.fa6a58"
            ]
        ]
    },
    {
        "id": "70a91f93.6bc53",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "null",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "sensor.tesla_battery_level",
        "state_type": "str",
        "state_location": "current_charge",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 440,
        "y": 600,
        "wires": [
            [
                "e30a9193.526e"
            ],
            []
        ]
    },
    {
        "id": "e30a9193.526e",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "Work out charge required",
        "func": "var target_charge_pct = msg.target_charge;\nvar current_charge_pct = msg.current_charge;\nvar charge_reqd_pct = 0.0;\n\nif (parseInt(target_charge_pct) > parseInt(current_charge_pct)) {\n    charge_reqd_pct = parseInt(target_charge_pct) - parseInt(current_charge_pct);\n    node.warn(\"Current charge is less than target\")\n} else {\n    charge_reqd_pct = 0;\n}\n\nvar charge_reqd_sessions = charge_reqd_pct / 7.53;\n\nvar charge_reqd_mins = Math.ceil(charge_reqd_sessions*30);\n\ncharge_reqd_sessions = Math.ceil(charge_reqd_sessions);\n\nmsg.charge_reqd_mins = charge_reqd_mins;\nmsg.charge_reqd_sessions = charge_reqd_sessions;\nmsg.charge_reqd_pct = charge_reqd_pct;\n\nflow.set('charge_reqd_pct',charge_reqd_pct);\nflow.set('charge_reqd_mins',charge_reqd_mins);\nflow.set('charge_reqd_sessions',charge_reqd_sessions);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is deployed.\n\nvar charge_reqd_pct;\nflow.set('charge_reqd_pct',charge_reqd_pct);\n\nvar charge_reqd_kWh;\nflow.set('charge_reqd_kWh',charge_reqd_kWh);\n\nvar charge_reqd_mins;\nflow.set('charge_reqd_mins',charge_reqd_mins);\n\nvar charge_reqd_sessions;\nflow.set('charge_reqd_sessions',charge_reqd_sessions);\n",
        "finalize": "",
        "x": 770,
        "y": 600,
        "wires": [
            [
                "ee259e2d.8e0a9"
            ]
        ]
    },
    {
        "id": "605389a1.550af8",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "Check tesla info",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 680,
        "wires": [
            [
                "36076e2f.3988e2"
            ]
        ]
    },
    {
        "id": "36076e2f.3988e2",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "device_tracker.tesla_location",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 430,
        "y": 680,
        "wires": [
            [
                "8fce1bf7.a95fe8"
            ],
            []
        ]
    },
    {
        "id": "8fce1bf7.a95fe8",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "sensor.tesla_plugged_in",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 770,
        "y": 660,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "238a1162.1996ce",
        "type": "chatbot-telegram-receive",
        "z": "9d235989.43e7e8",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "x": 250,
        "y": 1680,
        "wires": [
            [
                "e656bba1.7530a8",
                "234a197f.956f26"
            ]
        ]
    },
    {
        "id": "c3fb25c6.16b4e8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 1640,
        "wires": []
    },
    {
        "id": "e656bba1.7530a8",
        "type": "chatbot-rules",
        "z": "9d235989.43e7e8",
        "name": "",
        "rules": [
            {
                "type": "command",
                "command": "/charge_car"
            },
            {
                "type": "command",
                "command": "/changeday"
            },
            {
                "type": "command",
                "command": "/changetime"
            },
            {
                "type": "catchAll"
            }
        ],
        "outputs": 4,
        "x": 430,
        "y": 1680,
        "wires": [
            [
                "c3fb25c6.16b4e8"
            ],
            [
                "b4ce2fd1.e8c6a"
            ],
            [
                "d8153c9.86997c"
            ],
            [
                "de948291.0fe4b"
            ]
        ]
    },
    {
        "id": "ee259e2d.8e0a9",
        "type": "join-wait",
        "z": "9d235989.43e7e8",
        "name": "",
        "paths": "",
        "pathsToExpire": "",
        "useRegex": false,
        "warnUnmatched": true,
        "pathTopic": "topic",
        "pathTopicType": "msg",
        "correlationTopic": "",
        "correlationTopicType": "undefined",
        "timeout": 15000,
        "timeoutUnits": 1,
        "exactOrder": "false",
        "firstMsg": "true",
        "mapPayload": "false",
        "disableComplete": false,
        "x": 940,
        "y": 380,
        "wires": [
            [
                "bb22b434.6d70a8"
            ],
            []
        ]
    },
    {
        "id": "71e96321.1f073c",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Telegram",
        "info": "",
        "x": 100,
        "y": 1500,
        "wires": []
    },
    {
        "id": "6fd7469a.fa6a58",
        "type": "link out",
        "z": "9d235989.43e7e8",
        "name": "Update Est. Charge Time",
        "links": [
            "c3a8b1b6.23c14"
        ],
        "x": 935,
        "y": 460,
        "wires": []
    },
    {
        "id": "8d14a455.b4c6c8",
        "type": "ha-time",
        "z": "9d235989.43e7e8",
        "server": "a4a1abdf.7ba5b8",
        "name": "",
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityId": "input_datetime.ev_charged_time",
        "property": "state",
        "offset": 0,
        "offsetType": "num",
        "offsetUnits": "minutes",
        "randomOffset": false,
        "repeatDaily": false,
        "payload": "$entity().state",
        "payloadType": "jsonata",
        "debugenabled": true,
        "x": 170,
        "y": 980,
        "wires": [
            [
                "48b484f9.646acc"
            ]
        ]
    },
    {
        "id": "6eb3520f.e55b6c",
        "type": "api-call-service",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "debugenabled": false,
        "service_domain": "input_datetime",
        "service": "set_datetime",
        "entityId": "input_datetime.ev_charged_time",
        "data": "{    \"timestamp\" : {{payload}}}",
        "dataType": "json",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1060,
        "y": 980,
        "wires": [
            [
                "593ea6a9.084068"
            ]
        ]
    },
    {
        "id": "897ab5e6.eb3338",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "",
        "func": "var d_timestamp_s = msg.data.attributes.timestamp + msg.timeadjust;\nvar d_date = new Date(d_timestamp_s*1000);\n\nmsg.clear;\nmsg.payload = d_timestamp_s;\n\nmsg.message = \"EV Charge updated to \" + d_date.toDateString() + \" @ \" + d_date.getHours() + \":\" + d_date.getMinutes() + \"0\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 780,
        "y": 980,
        "wires": [
            [
                "6eb3520f.e55b6c"
            ]
        ]
    },
    {
        "id": "48b484f9.646acc",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "Add a day",
        "rules": [
            {
                "t": "set",
                "p": "timeadjust",
                "pt": "msg",
                "to": "86400",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 980,
        "wires": [
            [
                "897ab5e6.eb3338"
            ]
        ]
    },
    {
        "id": "49ba7f74.39712",
        "type": "chatbot-conversation",
        "z": "9d235989.43e7e8",
        "name": "",
        "botDevelopment": "c554ac1b.11e4",
        "botProduction": "c554ac1b.11e4",
        "chatId": "-421910568",
        "userId": "",
        "transport": "telegram",
        "store": "",
        "x": 890,
        "y": 1040,
        "wires": [
            [
                "ace99cf8.9ecb"
            ]
        ]
    },
    {
        "id": "7cce377.1cbf3c8",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1040,
        "wires": [
            [
                "162534e5.76b07b"
            ]
        ]
    },
    {
        "id": "162534e5.76b07b",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "test",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "null",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "input_datetime.ev_charged_time",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 290,
        "y": 1040,
        "wires": [
            [
                "48b484f9.646acc"
            ],
            []
        ]
    },
    {
        "id": "593ea6a9.084068",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "message",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1040,
        "wires": [
            [
                "49ba7f74.39712"
            ]
        ]
    },
    {
        "id": "d8153c9.86997c",
        "type": "link out",
        "z": "9d235989.43e7e8",
        "name": "/changeday",
        "links": [
            "4b6fd784.b0a178"
        ],
        "x": 635,
        "y": 1760,
        "wires": []
    },
    {
        "id": "828b9ce5.8e268",
        "type": "link in",
        "z": "9d235989.43e7e8",
        "name": "",
        "links": [
            "b4ce2fd1.e8c6a"
        ],
        "x": 95,
        "y": 1180,
        "wires": [
            [
                "b23bfc1a.33abb"
            ]
        ]
    },
    {
        "id": "51d81879.ff1478",
        "type": "chatbot-telegram-send",
        "z": "9d235989.43e7e8",
        "bot": "61c78e43.6e203",
        "botProduction": "c554ac1b.11e4",
        "track": true,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 2,
        "x": 450,
        "y": 1180,
        "wires": [
            [
                "cb2ecb6e.3320e8",
                "ebcbd75b.e3faa8"
            ],
            [
                "ebcbd75b.e3faa8"
            ]
        ]
    },
    {
        "id": "cb2ecb6e.3320e8",
        "type": "switch",
        "z": "9d235989.43e7e8",
        "name": "",
        "property": "payload.content",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 650,
        "y": 1180,
        "wires": [
            [
                "97d07095.cd714"
            ],
            [
                "e74cf4c0.892d28"
            ],
            [
                "8cfe3024.3e304"
            ],
            [
                "1d39e349.2fde5d"
            ]
        ]
    },
    {
        "id": "97d07095.cd714",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "today",
        "rules": [
            {
                "t": "set",
                "p": "date",
                "pt": "msg",
                "to": "{\t    \"date\": $fromMillis($millis(), '[Y0001]-[M01]-[D01]')\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 790,
        "y": 1120,
        "wires": [
            [
                "6900e7cb.f0aaa8"
            ]
        ]
    },
    {
        "id": "e74cf4c0.892d28",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "tomorrow",
        "rules": [
            {
                "t": "set",
                "p": "date",
                "pt": "msg",
                "to": "{ \"date\":$fromMillis($millis()+86400000, '[Y0001]-[M01]-[D01]')}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1160,
        "wires": [
            [
                "6900e7cb.f0aaa8"
            ]
        ]
    },
    {
        "id": "8cfe3024.3e304",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "+ 2 days",
        "rules": [
            {
                "t": "set",
                "p": "date",
                "pt": "msg",
                "to": "{\t    \"date\": $fromMillis($millis()+172800000, '[Y0001]-[M01]-[D01]')\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1200,
        "wires": [
            [
                "6900e7cb.f0aaa8"
            ]
        ]
    },
    {
        "id": "1d39e349.2fde5d",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "+ 3 days",
        "rules": [
            {
                "t": "set",
                "p": "date",
                "pt": "msg",
                "to": "{\t    \"date\": $fromMillis($millis()+259200000, '[Y0001]-[M01]-[D01]')\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1240,
        "wires": [
            [
                "6900e7cb.f0aaa8"
            ]
        ]
    },
    {
        "id": "6900e7cb.f0aaa8",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "date.date",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1000,
        "y": 1160,
        "wires": [
            [
                "83d09d6d.32c33"
            ]
        ]
    },
    {
        "id": "83d09d6d.32c33",
        "type": "api-call-service",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "debugenabled": false,
        "service_domain": "input_datetime",
        "service": "set_datetime",
        "entityId": "input_datetime.ev_charged_time",
        "data": "{\"date\":\"{{payload}}\"}",
        "dataType": "json",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1260,
        "y": 1160,
        "wires": [
            [
                "afc2cbab.341178"
            ]
        ]
    },
    {
        "id": "de948291.0fe4b",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 680,
        "y": 1820,
        "wires": []
    },
    {
        "id": "ec17dee5.dd11f",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 640,
        "y": 1240,
        "wires": [
            [
                "1d39e349.2fde5d"
            ]
        ]
    },
    {
        "id": "40825ee3.c3cff",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 640,
        "y": 1120,
        "wires": [
            [
                "97d07095.cd714"
            ]
        ]
    },
    {
        "id": "4b6fd784.b0a178",
        "type": "link in",
        "z": "9d235989.43e7e8",
        "name": "",
        "links": [
            "d8153c9.86997c"
        ],
        "x": 95,
        "y": 1380,
        "wires": [
            [
                "b1c2125e.204fe"
            ]
        ]
    },
    {
        "id": "60590322.92e0bc",
        "type": "chatbot-telegram-send",
        "z": "9d235989.43e7e8",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": true,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 2,
        "x": 450,
        "y": 1380,
        "wires": [
            [
                "f4190a6.eabecf8",
                "3b31eb06.6b4744"
            ],
            [
                "f4190a6.eabecf8"
            ]
        ]
    },
    {
        "id": "3b31eb06.6b4744",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.content",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 1380,
        "wires": [
            [
                "a0acf18c.9fbce",
                "af61fcc.92f09"
            ]
        ]
    },
    {
        "id": "a0acf18c.9fbce",
        "type": "api-call-service",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "debugenabled": false,
        "service_domain": "input_datetime",
        "service": "set_datetime",
        "entityId": "input_datetime.ev_charged_time",
        "data": "{\"time\":\"{{payload}}\"}",
        "dataType": "json",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1260,
        "y": 1360,
        "wires": [
            [
                "afc2cbab.341178"
            ]
        ]
    },
    {
        "id": "b4ce2fd1.e8c6a",
        "type": "link out",
        "z": "9d235989.43e7e8",
        "name": "",
        "links": [
            "828b9ce5.8e268"
        ],
        "x": 645,
        "y": 1720,
        "wires": []
    },
    {
        "id": "1a9adc23.f08d44",
        "type": "link in",
        "z": "9d235989.43e7e8",
        "name": "EV Date/Time Updated",
        "links": [
            "97d41610.f76118",
            "a8ced89d.47d098",
            "620d4d4d.992fa4"
        ],
        "x": 735,
        "y": 1060,
        "wires": [
            [
                "49ba7f74.39712"
            ]
        ]
    },
    {
        "id": "afc2cbab.341178",
        "type": "api-current-state",
        "z": "9d235989.43e7e8",
        "name": "",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "outputs": 2,
        "halt_if": "null",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "override_topic": false,
        "entity_id": "input_datetime.ev_charged_time",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 1600,
        "y": 1280,
        "wires": [
            [
                "376e2d2a.a0c0e2"
            ],
            []
        ]
    },
    {
        "id": "376e2d2a.a0c0e2",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "",
        "func": "var d_timestamp_s = msg.data.attributes.timestamp;\nvar d_date = new Date(d_timestamp_s*1000);\n\nmsg.payload = \"EV Charge updated to \" + d_date.toDateString() + \" @ \" + d_date.getHours() + \":\" + d_date.getMinutes() + \"0\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1880,
        "y": 1280,
        "wires": [
            [
                "620d4d4d.992fa4"
            ]
        ]
    },
    {
        "id": "620d4d4d.992fa4",
        "type": "link out",
        "z": "9d235989.43e7e8",
        "name": "",
        "links": [
            "1a9adc23.f08d44"
        ],
        "x": 1975,
        "y": 1280,
        "wires": []
    },
    {
        "id": "a468c38c.9c7be",
        "type": "chatbot-telegram-send",
        "z": "9d235989.43e7e8",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": false,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 1,
        "x": 1350,
        "y": 1040,
        "wires": [
            [
                "afbf5366.c91a8"
            ]
        ]
    },
    {
        "id": "ace99cf8.9ecb",
        "type": "chatbot-inline-buttons",
        "z": "9d235989.43e7e8",
        "name": "",
        "buttons": [
            {
                "type": "postback",
                "label": "Change Day",
                "value": "/changeday",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "Change Time",
                "value": "/changetime",
                "answer": "",
                "alert": false,
                "style": ""
            }
        ],
        "message": "{{payload}}",
        "x": 1140,
        "y": 1040,
        "wires": [
            [
                "a468c38c.9c7be",
                "afbf5366.c91a8"
            ]
        ]
    },
    {
        "id": "afbf5366.c91a8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1550,
        "y": 1000,
        "wires": []
    },
    {
        "id": "b23bfc1a.33abb",
        "type": "chatbot-inline-buttons",
        "z": "9d235989.43e7e8",
        "name": "",
        "buttons": [
            {
                "type": "postback",
                "label": "Today",
                "value": "0",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "Tomorrow",
                "value": "1",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "+ 2 days",
                "value": "2",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "+ 3 days",
                "value": "3",
                "answer": "",
                "alert": false,
                "style": ""
            }
        ],
        "message": "What day do you want the car charged?",
        "x": 240,
        "y": 1180,
        "wires": [
            [
                "51d81879.ff1478"
            ]
        ]
    },
    {
        "id": "b1c2125e.204fe",
        "type": "chatbot-inline-buttons",
        "z": "9d235989.43e7e8",
        "name": "",
        "buttons": [
            {
                "type": "postback",
                "label": "04:00",
                "value": "04:00:00",
                "answer": "",
                "alert": true,
                "style": ""
            },
            {
                "type": "postback",
                "label": "06:00",
                "value": "06:00:00",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "10:00",
                "value": "10:00:00",
                "answer": "",
                "alert": false,
                "style": ""
            },
            {
                "type": "postback",
                "label": "17:00",
                "value": "17:00:00",
                "answer": "",
                "alert": false,
                "style": ""
            }
        ],
        "message": "What time do you want the car charged?",
        "x": 240,
        "y": 1380,
        "wires": [
            [
                "60590322.92e0bc"
            ]
        ]
    },
    {
        "id": "f4190a6.eabecf8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1500,
        "wires": []
    },
    {
        "id": "234a197f.956f26",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 410,
        "y": 1760,
        "wires": []
    },
    {
        "id": "af61fcc.92f09",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 1420,
        "wires": []
    },
    {
        "id": "b470df5e.7b471",
        "type": "catch",
        "z": "9d235989.43e7e8",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 650,
        "y": 860,
        "wires": [
            [
                "bcc23a22.dec378"
            ]
        ]
    },
    {
        "id": "bcc23a22.dec378",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 860,
        "wires": []
    },
    {
        "id": "39012d9e.319c82",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "",
        "func": "var chat = msg.chat();\nvar messageId = chat.get('messageId');\nvar chatId = chat.get('chatId');\nvar message = chat.get('message');\n\ndelete msg.payload.buttons;\n\nmsg.payload = {    \n  chatId: chatId,    \n  messageId: messageId,\n  buttons: [{ type: 'postback', value: 'clicked', label: 'Clicked!' }],\n  content: message\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 620,
        "y": 1300,
        "wires": [
            [
                "96f31880.9b4018",
                "745df0f8.c7226"
            ]
        ]
    },
    {
        "id": "707fae08.c0616",
        "type": "chatbot-telegram-send",
        "z": "9d235989.43e7e8",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": true,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 2,
        "x": 1050,
        "y": 1280,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "745df0f8.c7226",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1190,
        "y": 1220,
        "wires": []
    },
    {
        "id": "96f31880.9b4018",
        "type": "chatbot-conversation",
        "z": "9d235989.43e7e8",
        "name": "",
        "botDevelopment": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "chatId": "",
        "userId": "",
        "transport": "telegram",
        "store": "",
        "x": 790,
        "y": 1300,
        "wires": [
            [
                "29bc65c3.99ceba"
            ]
        ]
    },
    {
        "id": "29bc65c3.99ceba",
        "type": "chatbot-inline-buttons",
        "z": "9d235989.43e7e8",
        "name": "",
        "buttons": [],
        "message": "",
        "x": 920,
        "y": 1340,
        "wires": [
            [
                "707fae08.c0616"
            ]
        ]
    },
    {
        "id": "99df7bc4.95fee8",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Not used",
        "info": "",
        "x": 580,
        "y": 1300,
        "wires": []
    },
    {
        "id": "ebcbd75b.e3faa8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 410,
        "y": 1300,
        "wires": []
    },
    {
        "id": "e4885b83.11ae38",
        "type": "inject",
        "z": "d4f39d50.9849d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1270,
        "y": 580,
        "wires": [
            [
                "bf4283d7.698a6"
            ]
        ]
    },
    {
        "id": "bf4283d7.698a6",
        "type": "file in",
        "z": "d4f39d50.9849d",
        "name": "",
        "filename": "/data/dishwasherDB.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 1480,
        "y": 580,
        "wires": [
            [
                "7850d89.0e0e528"
            ]
        ]
    },
    {
        "id": "7850d89.0e0e528",
        "type": "debug",
        "z": "d4f39d50.9849d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1610,
        "y": 640,
        "wires": []
    },
    {
        "id": "cdb2b04b.b49f6",
        "type": "chatbot-conversation",
        "z": "d4f39d50.9849d",
        "name": "",
        "botDevelopment": "c554ac1b.11e4",
        "botProduction": "c554ac1b.11e4",
        "chatId": "-433189292",
        "userId": "",
        "transport": "telegram",
        "store": "",
        "x": 1370,
        "y": 260,
        "wires": [
            [
                "f2067020.d73dc"
            ]
        ]
    },
    {
        "id": "bbfd9b2d.8643e8",
        "type": "chatbot-telegram-send",
        "z": "d4f39d50.9849d",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": false,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 1,
        "x": 1710,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "e1449065.0edf2",
        "type": "catch",
        "z": "d4f39d50.9849d",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 850,
        "y": 100,
        "wires": [
            [
                "3c69b284.2e696e"
            ]
        ]
    },
    {
        "id": "f2067020.d73dc",
        "type": "chatbot-message",
        "z": "d4f39d50.9849d",
        "name": "",
        "message": [
            {
                "message": "{{payload}}"
            }
        ],
        "language": "none",
        "x": 1510,
        "y": 260,
        "wires": [
            [
                "bbfd9b2d.8643e8"
            ]
        ]
    },
    {
        "id": "e7a98d0b.d1da5",
        "type": "chatbot-conversation",
        "z": "fd719e13.69936",
        "name": "",
        "botDevelopment": "c554ac1b.11e4",
        "botProduction": "c554ac1b.11e4",
        "chatId": "-433189292",
        "userId": "",
        "transport": "telegram",
        "store": "",
        "x": 1250,
        "y": 260,
        "wires": [
            [
                "c98bc8cc.669a58"
            ]
        ]
    },
    {
        "id": "483a010e.81114",
        "type": "chatbot-telegram-send",
        "z": "fd719e13.69936",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": false,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 1,
        "x": 1590,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "c98bc8cc.669a58",
        "type": "chatbot-message",
        "z": "fd719e13.69936",
        "name": "",
        "message": [
            {
                "message": "{{payload}}"
            }
        ],
        "language": "none",
        "x": 1390,
        "y": 260,
        "wires": [
            [
                "483a010e.81114"
            ]
        ]
    },
    {
        "id": "3aba1fa4.4a161",
        "type": "chatbot-conversation",
        "z": "5365d4a0.afc36c",
        "name": "",
        "botDevelopment": "c554ac1b.11e4",
        "botProduction": "c554ac1b.11e4",
        "chatId": "-433189292",
        "userId": "",
        "transport": "telegram",
        "store": "",
        "x": 1190,
        "y": 420,
        "wires": [
            [
                "d243627d.52365"
            ]
        ]
    },
    {
        "id": "d66b375f.f749a8",
        "type": "chatbot-telegram-send",
        "z": "5365d4a0.afc36c",
        "bot": "61c78e43.6e203",
        "botProduction": "61c78e43.6e203",
        "track": false,
        "passThrough": false,
        "errorOutput": true,
        "outputs": 1,
        "x": 1530,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "d243627d.52365",
        "type": "chatbot-message",
        "z": "5365d4a0.afc36c",
        "name": "",
        "message": [
            {
                "message": "{{payload}}"
            }
        ],
        "language": "none",
        "x": 1330,
        "y": 420,
        "wires": [
            [
                "d66b375f.f749a8"
            ]
        ]
    },
    {
        "id": "46451bbb.1225d4",
        "type": "poll-state",
        "z": "9d235989.43e7e8",
        "name": "If charged time is in the past",
        "server": "a4a1abdf.7ba5b8",
        "version": 1,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "updateinterval": "20",
        "updateIntervalUnits": "minutes",
        "outputinitially": false,
        "outputonchanged": false,
        "entity_id": "input_datetime.ev_charged_time",
        "state_type": "str",
        "halt_if": "$now()",
        "halt_if_type": "jsonata",
        "halt_if_compare": "lt",
        "outputs": 2,
        "x": 160,
        "y": 880,
        "wires": [
            [
                "48b484f9.646acc"
            ],
            []
        ]
    },
    {
        "id": "df4d4169.ad831",
        "type": "influxdb in",
        "z": "9d235989.43e7e8",
        "influxdb": "d4f057b1.bf3418",
        "name": "",
        "query": "SELECT mean(\"agile_rate\") AS \"mean_agile_rate\" FROM \"energy\".\"autogen\".\"electricity\" WHERE time >= now()-30d AND time <= now() GROUP BY \"time_of_day\"\n",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 400,
        "y": 1960,
        "wires": [
            [
                "9e7d51fb.955b3"
            ]
        ]
    },
    {
        "id": "7925b6a5.91ae58",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1800",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 1940,
        "wires": [
            [
                "df4d4169.ad831"
            ]
        ]
    },
    {
        "id": "be491892.3566d8",
        "type": "debug",
        "z": "9d235989.43e7e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 2040,
        "wires": []
    },
    {
        "id": "374f44cc.931d5c",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 970,
        "y": 520,
        "wires": [
            [
                "bb22b434.6d70a8"
            ]
        ]
    },
    {
        "id": "9e7d51fb.955b3",
        "type": "function",
        "z": "9d235989.43e7e8",
        "name": "",
        "func": "var i;\nvar schedule_avg = new Object();\n\nfor (i in msg.payload) {\n    if (msg.payload[i].time_of_day) {\n\n   // node.warn(i + \" \" + msg.payload[i].time_of_day)\n    schedule_avg[msg.payload[i].time_of_day] = msg.payload[i].mean_agile_rate.toFixed(2);\n    }\n}\n\n///WORKAROUND FOR MIDNIGHT\nschedule_avg['00:00'] = schedule_avg['00:30'];\n\nflow.set('schedule_avg',schedule_avg);\n\nmsg.payload = schedule_avg;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 670,
        "y": 1960,
        "wires": [
            [
                "be491892.3566d8",
                "f7ccd97c.f43d68"
            ]
        ]
    },
    {
        "id": "aa0f156b.2d18f8",
        "type": "inject",
        "z": "9d235989.43e7e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 500,
        "wires": [
            [
                "1a863aee.f0e2e5"
            ]
        ]
    },
    {
        "id": "ed238594.ee6fe8",
        "type": "complete",
        "z": "9d235989.43e7e8",
        "name": "",
        "scope": [
            "875d8e52.55207"
        ],
        "uncaught": false,
        "x": 230,
        "y": 780,
        "wires": [
            [
                "fc385600.193b08"
            ]
        ]
    },
    {
        "id": "f94dd7b5.c32038",
        "type": "file",
        "z": "9d235989.43e7e8",
        "name": "",
        "filename": "/data/evcharger/curr_schedule.json",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 660,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "fc385600.193b08",
        "type": "change",
        "z": "9d235989.43e7e8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "schedule",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 780,
        "wires": [
            [
                "f94dd7b5.c32038"
            ]
        ]
    },
    {
        "id": "25474bb7.413174",
        "type": "comment",
        "z": "9d235989.43e7e8",
        "name": "Save Schedule Object",
        "info": "",
        "x": 120,
        "y": 740,
        "wires": []
    }
]